
  <!DOCTYPE html>
  <html lang="zh-CN"  >
  <head>
  <meta charset="utf-8">
  

  

  

  
  <title>
    Bomb Lab实验 |
    
    Ycx&#39;Blog
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CUbuntu%20Mono:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;">
  
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/regular.min.css">
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/solid.min.css">

  <link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/brands.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v5-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v4-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;">
  
<link rel="stylesheet" href="/css/loader.css">

  <meta name="description" content="软件2204 戴腾宇 202226010418  一、bomblab相关介绍  1.简介 此次实验要求我们使用课程所学知识拆除“binary bombs”，增强对程序的机器级表示、汇编语言、调试器和逆向工程等方面原理与技能的掌握。 一个“binary bombs”（二进制炸弹）是一个Linux可执行程序，包含了6个阶段。炸弹运行的每个阶段要求你输入一个特定字符串，你的输入符合程序预期的输入，该阶">
<meta property="og:type" content="article">
<meta property="og:title" content="Bomb Lab实验">
<meta property="og:url" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/index.html">
<meta property="og:site_name" content="Ycx&#39;Blog">
<meta property="og:description" content="软件2204 戴腾宇 202226010418  一、bomblab相关介绍  1.简介 此次实验要求我们使用课程所学知识拆除“binary bombs”，增强对程序的机器级表示、汇编语言、调试器和逆向工程等方面原理与技能的掌握。 一个“binary bombs”（二进制炸弹）是一个Linux可执行程序，包含了6个阶段。炸弹运行的每个阶段要求你输入一个特定字符串，你的输入符合程序预期的输入，该阶">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220159435-17141416733591.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220211762.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240419210211585.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240419214923670.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220303281.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422115323390.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220322775.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422210043013.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/C:%5CUsers%5C%E5%8D%97%E6%B8%A1%E7%9A%84%E5%8D%97%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240422220559005.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220523054.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422224007580.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425161836713.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425163713343.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425162039022.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425162823116.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425162908608.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425173820150.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425174146868.png">
<meta property="og:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425174444806.png">
<meta property="article:published_time" content="2024-04-17T05:44:57.000Z">
<meta property="article:modified_time" content="2024-04-26T14:30:10.664Z">
<meta property="article:author" content="Ycx.Cc">
<meta property="article:tag" content="实验">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220159435-17141416733591.png">
  
    <link rel="alternate" href="/atom.xml" title="Ycx'Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css">

  
  
  
  
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"></script>

  
    
<link rel="stylesheet" href="https://npm.webcache.cn/wowjs@1.1.3/css/libs/animate.css">

    
<script src="https://npm.webcache.cn/wowjs@1.1.3/dist/wow.min.js"></script>

    <script>
      new WOW({
        offset: 0,
        mobile: true,
        live: false
      }).init();
    </script>
  
  
    <script src="/sw.js"></script>
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg"></div>
    <div class="loading-right-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
          <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="#ff6e6b" />
          <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z" fill="#fd0d00" />
          <path d="M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95" fill="#fd0d00" />
        </svg>
      </div>
      <div class="loading-word">少女祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    const startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    const endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('load', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/">首页</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/archives">归档</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/about">关于</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/friend">友链</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="搜索"></a>
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="搜索"></a>
    
  </nav>
</div>
<header id="header">
  
    <img fetchpriority="high" src="/images/banner.jpg" alt="Bomb Lab实验">
  
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div id="logo-wrap">
        
          
          
            <a href="/" id="logo">
              <h1>Bomb Lab实验</h1>
            </a>
          
        
      </div>
      
        
        <h2 id="subtitle-wrap">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content" class="outer">
          
            <aside id="sidebar">
  <div class="sidebar-wrap wow fadeInRight wrap-sticky">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B62204-%E6%88%B4%E8%85%BE%E5%AE%87-202226010418"><span class="toc-number">1.</span> <span class="toc-text"> 软件2204 戴腾宇 202226010418</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-bomblab%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D"><span class="toc-number"></span> <span class="toc-text"> 一、bomblab相关介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text"> 1.简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.</span> <span class="toc-text"> 2.实验步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#21%E8%8E%B7%E5%8F%96bomb"><span class="toc-number">2.1.</span> <span class="toc-text"> 2.1.获取bomb</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#22%E6%8B%86%E9%99%A4bomb"><span class="toc-number">2.2.</span> <span class="toc-text"> 2.2.拆除bomb</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8"><span class="toc-number"></span> <span class="toc-text"> 二、工具使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number"></span> <span class="toc-text"> 三、准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E8%BF%9B%E8%A1%8C%E6%8B%86%E5%BC%B9"><span class="toc-number"></span> <span class="toc-text"> 四、进行拆弹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.</span> <span class="toc-text"> 1.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">2.</span> <span class="toc-text"> 2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">3.</span> <span class="toc-text"> 3.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-number">4.</span> <span class="toc-text"> 4.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5"><span class="toc-number">5.</span> <span class="toc-text"> 5.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6"><span class="toc-number">6.</span> <span class="toc-text"> 6.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#secret_phase"><span class="toc-number">7.</span> <span class="toc-text"> secret_phase</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8phase_defused%E4%B8%AD"><span class="toc-number">7.1.</span> <span class="toc-text"> 在phase_defused中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8serect_phase%E5%87%BD%E6%95%B0%E4%B8%AD"><span class="toc-number">7.2.</span> <span class="toc-text"> 在serect_phase函数中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8func7%E5%87%BD%E6%95%B0%E4%B8%AD"><span class="toc-number">7.3.</span> <span class="toc-text"> 在func7函数中</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number"></span> <span class="toc-text"> 五、实验总结</span></a></div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="Ycx.Cc" class="lazyload">
  <div class="sidebar-author-name">Ycx.Cc</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">21</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">7</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">16</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class=icon-github>
      <a href=https://github.com/Ycx6666 itemprop="url" target="_blank" aria-label="github"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>
</div>
    
    
      <div class="sidebar-btn-wrapper" style="position:static">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
    
  </div>

  
</aside>

          
          <section id="main"><article id="post-Bomb实验" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    <div class="article-meta">
      <div class="article-date wow slideInLeft">
  <a href="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/" class="article-date-link">
    <time datetime="2024-04-17T05:44:57.000Z" itemprop="datePublished">2024-04-17</time>
  </a>
</div>

      
  <div class="article-category wow slideInLeft">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">计算机系统</a>
  </div>


    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="软件2204-戴腾宇-202226010418"><a class="markdownIt-Anchor" href="#软件2204-戴腾宇-202226010418"></a> 软件2204 戴腾宇 202226010418</h3>
<h2 id="一-bomblab相关介绍"><a class="markdownIt-Anchor" href="#一-bomblab相关介绍"></a> 一、bomblab相关介绍</h2>
<h3 id="1简介"><a class="markdownIt-Anchor" href="#1简介"></a> 1.简介</h3>
<p>此次实验要求我们使用课程所学知识拆除“binary bombs”，增强对程序的机器级表示、汇编语言、调试器和逆向工程等方面原理与技能的掌握。</p>
<p>一个“binary bombs”（二进制炸弹）是一个Linux可执行程序，包含了6个阶段。炸弹运行的每个阶段要求你输入一个特定字符串，你的输入符合程序预期的输入，该阶段的炸弹就被拆除引信即解除了，否则炸弹“爆炸”打印输出 “BOOM!!!”。</p>
<p>实验的目标是拆除尽可能多的炸弹层次。 每个炸弹阶段考察了机器级程序语言的一个不同方面，难度逐级递增：</p>
<p>阶段1：字符串比较</p>
<p>阶段2：循环</p>
<p>阶段3：条件/分支</p>
<p>阶段4：递归调用和栈</p>
<p>阶段5：指针</p>
<p>阶段6：链表/指针/结构</p>
<p>隐藏阶段：只有在第4阶段的解后加特定字符串才会出现</p>
<p>为完成二进制炸弹拆除任务，我们需要使用gdb调试器和objdump来反汇编炸弹的可执行文件并跟踪调试每一阶段的机器代码，从中理解每一汇编语言代码的行为或作用，进而设法推断拆除炸弹所需的目标字符串。比如在每一阶段的开始代码前和引爆炸弹的函数前设置断点。</p>
<p>实验语言：C；实验环境：Linux</p>
<h3 id="2实验步骤"><a class="markdownIt-Anchor" href="#2实验步骤"></a> 2.实验步骤</h3>
<h4 id="21获取bomb"><a class="markdownIt-Anchor" href="#21获取bomb"></a> 2.1.获取bomb</h4>
<p>获取炸弹文件<code>bomb18_202226010418</code>，对应自己的学号</p>
<p>得到一个目录./bomb，其中包含如下文件：</p>
<p>​	README：标识该bomb和所有者(匹配自己的学号)。</p>
<p>​	bomb：bomb的可执行程序。</p>
<p>​	bomb.c：bomb程序的main函数。</p>
<h4 id="22拆除bomb"><a class="markdownIt-Anchor" href="#22拆除bomb"></a> 2.2.拆除bomb</h4>
<p>本实验的任务就是拆除炸弹。一定要在指定的虚拟机上完成作业，在其他的环境上运行有可能导致失败。</p>
<ol>
<li>
<p>运行./bomb可执行程序需要0或1个命令行参数（详见bomb.c源文件中的main()函数）。如果运行时不指定参数，则该程序打印出欢迎信息后，期望按行输入每一阶段用来拆除炸弹的字符串，根据当前输入的字符串决定是通过相应阶段还是炸弹爆炸导致任务失败。</p>
</li>
<li>
<p>也可将拆除每一阶段炸弹的字符串按行组织在一个文本文件中，然后作为运行程序时的唯一一个命令行参数传给程序，程序读入文件中的每一行直到遇到EOF，再转到从stdin等待输入。这样对于已经拆除的炸弹，就不用每次都重新输入，只用放进文件里即可。</p>
</li>
<li>
<p>要学会单步跟踪调试汇编代码以及学会设置断点。你还要学会如何检查寄存器和内存状态。很好的使用调试器是你在未来的职业生涯中赚到更多money的一项重要技能！</p>
</li>
</ol>
<h2 id="二-工具使用"><a class="markdownIt-Anchor" href="#二-工具使用"></a> 二、工具使用</h2>
<ul>
<li>
<p>gdb调试工具</p>
</li>
<li>
<p>objdump反汇编工具</p>
</li>
</ul>
<h2 id="三-准备工作"><a class="markdownIt-Anchor" href="#三-准备工作"></a> 三、准备工作</h2>
<p>1.打开bomb.c文件</p>
<blockquote>
<p>发现main函数依次调用了phase_1到phase_6六个函数，但函数的具体代码被隐藏。可以知道从命令行输入的内容必须和phase函数里面的一样，否则炸弹爆炸。</p>
</blockquote>
<p>2.反汇编可执行文件bomb</p>
<p><code>  objdump -d bomb &gt; bomb.asm</code></p>
<p>这样就可以在bomb.asm里面看到整个文件的汇编代码。</p>
<h2 id="四-进行拆弹"><a class="markdownIt-Anchor" href="#四-进行拆弹"></a> 四、进行拆弹</h2>
<h3 id="1"><a class="markdownIt-Anchor" href="#1"></a> 1.</h3>
<ol>
<li>
<p>使用gdb查看地址0x804a284</p>
</li>
<li>
<p>在%eax种输入的是我们的参数，推测在0x804a284中存放的是用于比较的参数，即密码</p>
</li>
<li>
<p>在下一行设置断点</p>
</li>
<li>
<p>然后随便输入一个字符串，让程序继续运行下去</p>
</li>
<li>
<p>通过x/s 0x804a284</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220159435-17141416733591.png" alt="image-20240422220159435"></p>
</li>
</ol>
<p>“All your base are belong to us.”</p>
<h3 id="2"><a class="markdownIt-Anchor" href="#2"></a> 2.</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">08048b74 &lt;phase_2&gt;:</span><br><span class="line"> 8048b74:	56                   	push   %esi</span><br><span class="line"> 8048b75:	53                   	push   %ebx</span><br><span class="line"> 8048b76:	83 ec 34             	sub    $0x34,%esp //开辟栈</span><br><span class="line"> 8048b79:	8d 44 24 18          	lea    0x18(%esp),%eax //将0x18+esp的值存入eax</span><br><span class="line"> 8048b7d:	89 44 24 04          	mov    %eax,0x4(%esp) //eax的值放入0x4+esp</span><br><span class="line"> 8048b81:	8b 44 24 40          	mov    0x40(%esp),%eax  //0x40+esp的值放入eax</span><br><span class="line"> 8048b85:	89 04 24             	mov    %eax,(%esp) //eax 的值放入esp</span><br><span class="line"> 8048b88:	e8 5e 07 00 00       	call   80492eb &lt;read_six_numbers&gt; //读取六个数字</span><br><span class="line"> 8048b8d:	83 7c 24 18 01       	cmpl   $0x1,0x18(%esp) // 比较1和0x18(%esp)，相等设置ZF为1</span><br><span class="line"> 8048b92:	74 05                	je     8048b99 &lt;phase_2+0x25&gt;//1跳...99</span><br><span class="line"> 8048b94:	e8 1d 06 00 00       	call   80491b6 &lt;explode_bomb&gt;//不是1炸 第一个数只能是1</span><br><span class="line"> 8048b99:	8d 5c 24 1c          	lea    0x1c(%esp),%ebx  //je地址</span><br><span class="line"> 8048b9d:	8d 74 24 30          	lea    0x30(%esp),%esi //esp+0x1c到0x30中间的值</span><br><span class="line"> 8048ba1:	8b 43 fc             	mov    -0x4(%ebx),%eax  //jne地址</span><br><span class="line"> 8048ba4:	01 c0                	add    %eax,%eax //乘以2</span><br><span class="line"> 8048ba6:	39 03                	cmp    %eax,(%ebx)//比较%eax和(%ebx)中的值</span><br><span class="line"> 8048ba8:	74 05                	je     8048baf &lt;phase_2+0x3b&gt;//跳转到这个函数</span><br><span class="line"> 8048baa:	e8 07 06 00 00       	call   80491b6 &lt;explode_bomb&gt; //调用爆炸函数</span><br><span class="line"> 8048baf:	83 c3 04             	add    $0x4,%ebx //++</span><br><span class="line"> 8048bb2:	39 f3                	cmp    %esi,%ebx </span><br><span class="line"> 8048bb4:	75 eb                	jne    8048ba1 &lt;phase_2+0x2d&gt; //如果不相等就跳  第二个数应该是第一个数的两倍</span><br><span class="line"> 8048bb6:	83 c4 34             	add    $0x34,%esp</span><br><span class="line"> 8048bb9:	5b                   	pop    %ebx</span><br><span class="line"> 8048bba:	5e                   	pop    %esi</span><br><span class="line"> 8048bbb:	c3                   	ret   </span><br></pre></td></tr></table></figure>
<p>“1 2 4 8 16 32”</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220211762.png" alt="image-20240422220211762"></p>
<h3 id="3"><a class="markdownIt-Anchor" href="#3"></a> 3.</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">08048b</span>bc &lt;phase_3&gt;:</span><br><span class="line"> <span class="number">8048b</span>bc:	<span class="number">83</span> ec <span class="number">3</span>c             	sub    $<span class="number">0x3c</span>,%esp</span><br><span class="line"> <span class="number">8048b</span>bf:	<span class="number">8</span>d <span class="number">44</span> <span class="number">24</span> <span class="number">28</span>          	lea    <span class="number">0x28</span>(%esp),%eax  							<span class="comment">//eax=0x28+esp=a</span></span><br><span class="line"> <span class="number">8048b</span>c3:	<span class="number">89</span> <span class="number">44</span> <span class="number">24</span> <span class="number">10</span>          	mov    %eax,<span class="number">0x10</span>(%esp) 								<span class="comment">//将esp+0x28存放的数值放入esp+0x10=a</span></span><br><span class="line"> <span class="number">8048b</span>c7:	<span class="number">8</span>d <span class="number">44</span> <span class="number">24</span> <span class="number">2f</span>          	lea    <span class="number">0x2f</span>(%esp),%eax  							<span class="comment">//eax=esp+0x2f</span></span><br><span class="line"> <span class="number">8048b</span>cb:	<span class="number">89</span> <span class="number">44</span> <span class="number">24</span> <span class="number">0</span>c          	mov    %eax,<span class="number">0xc</span>(%esp)									<span class="comment">//将esp+0x2f存放的数值放入0xc+esp=b</span></span><br><span class="line"> <span class="number">8048b</span>cf:	<span class="number">8</span>d <span class="number">44</span> <span class="number">24</span> <span class="number">24</span>          	lea    <span class="number">0x24</span>(%esp),%eax								<span class="comment">//eax=24+esp</span></span><br><span class="line"> <span class="number">8048b</span>d3:	<span class="number">89</span> <span class="number">44</span> <span class="number">24</span> <span class="number">08</span>          	mov    %eax,<span class="number">0x8</span>(%esp)									<span class="comment">//将esp+0x24存放的数值放入0x8+esp=c</span></span><br><span class="line"> <span class="number">8048b</span>d7:	c7 <span class="number">44</span> <span class="number">24</span> <span class="number">04</span> ca a2 <span class="number">04</span> 	movl   $<span class="number">0x804a2ca</span>,<span class="number">0x4</span>(%esp)						<span class="comment">//这个立即数放入0x4+esp中</span></span><br><span class="line"> <span class="number">8048b</span>de:	<span class="number">08</span> </span><br><span class="line"> <span class="number">8048b</span>df:	<span class="number">8b</span> <span class="number">44</span> <span class="number">24</span> <span class="number">40</span>          	mov    <span class="number">0x40</span>(%esp),%eax</span><br><span class="line"> <span class="number">8048b</span>e3:	<span class="number">89</span> <span class="number">04</span> <span class="number">24</span>             	mov    %eax,(%esp) <span class="comment">//将0x40+esp放入eax，esp指向esp+40的值=d</span></span><br><span class="line"> <span class="number">8048b</span>e6:	e8 <span class="number">85</span> fc ff ff       	call   <span class="number">8048870</span> &lt;__isoc99_sscanf@plt&gt;  </span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> 这里存在了一个输入，注意到前面将一个立即数存入了esp+0x4，使用x/s查看这个地址的信息</span></span><br><span class="line"><span class="comment"> 发现这里输入了三个参数 &quot;%d %c %d&quot;对用int char int 分别对应了a,b,c</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="number">8048b</span>eb:	<span class="number">83</span> f8 <span class="number">02</span>             	cmp    $<span class="number">0x2</span>,%eax		<span class="comment">//检查0x2和eax的大小</span></span><br><span class="line"> <span class="number">8048b</span>ee:	<span class="number">7f</span> <span class="number">05</span>                	jg     <span class="number">8048b</span>f5 &lt;phase_3+<span class="number">0x39</span>&gt;  <span class="comment">//当eax&gt;2时跳转到bf5，其实也就是输入成功</span></span><br><span class="line"> <span class="number">8048b</span>f0:	e8 c1 <span class="number">05</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt;		<span class="comment">//小于等于2就引爆炸弹，也就是输入的数x必须大于2，其实也就是输入失败了</span></span><br><span class="line"> <span class="number">8048b</span>f5:	<span class="number">83</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">24</span> <span class="number">07</span>       	cmpl   $<span class="number">0x7</span>,<span class="number">0x24</span>(%esp)		<span class="comment">//比较，如果esp+0x24的值大于7.，也就时c大于7</span></span><br><span class="line"> <span class="number">8048b</span>fa:	<span class="number">0f</span> <span class="number">87</span> f3 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    	ja     <span class="number">8048</span>cf3 &lt;phase_3+<span class="number">0x137</span>&gt; <span class="comment">//大于7跳转到cf3，也就是炸弹爆炸的call，那么c必须小于等于7</span></span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> 这里给了一个提示，也就是在三个参数中，c的值是小于等于7的。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="number">8048</span>c00:	<span class="number">8b</span> <span class="number">44</span> <span class="number">24</span> <span class="number">24</span>          	mov    <span class="number">0x24</span>(%esp),%eax <span class="comment">//eax=c</span></span><br><span class="line"> <span class="number">8048</span>c04:	ff <span class="number">24</span> <span class="number">85</span> e0 a2 <span class="number">04</span> <span class="number">08</span> 	jmp    *<span class="number">0x804a2e0</span>(,%eax,<span class="number">4</span>) 跳转到<span class="number">4</span>c+*<span class="number">0x804a2e0</span></span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> 这里对应了八个分支，也就是八种可能</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="number">8048</span>c0b:	b8 <span class="number">66</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x66</span>,%eax <span class="comment">//eax=66</span></span><br><span class="line"> <span class="number">8048</span>c10:	<span class="number">83</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> <span class="number">67</span>       	cmpl   $<span class="number">0x67</span>,<span class="number">0x28</span>(%esp)  <span class="comment">//比较a和67的大小</span></span><br><span class="line"> <span class="number">8048</span>c15:	<span class="number">0f</span> <span class="number">84</span> e2 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt; <span class="comment">//如果a=67，跳转到8048cfd</span></span><br><span class="line"> <span class="number">8048</span>c1b:	e8 <span class="number">96</span> <span class="number">05</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt;<span class="comment">//不相等，炸，也就是说a必须等于67</span></span><br><span class="line"> <span class="number">8048</span>c20:	b8 <span class="number">66</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x66</span>,%eax  <span class="comment">//eax=66</span></span><br><span class="line"> <span class="number">8048</span>c25:	e9 d3 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;  <span class="comment">//跳转到8048cfd，那里比较b和66的大小</span></span><br><span class="line"> <span class="number">8048</span>c2a:	b8 <span class="number">76</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x76</span>,%eax  <span class="comment">//eax=76</span></span><br><span class="line"> <span class="number">8048</span>c2f:	<span class="number">83</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> <span class="number">52</span>       	cmpl   $<span class="number">0x52</span>,<span class="number">0x28</span>(%esp) <span class="comment">//比较a和52的大小</span></span><br><span class="line"> <span class="number">8048</span>c34:	<span class="number">0f</span> <span class="number">84</span> c3 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt; <span class="comment">//如果a=52，跳转到cfd</span></span><br><span class="line"> <span class="number">8048</span>c3a:	e8 <span class="number">77</span> <span class="number">05</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt;  <span class="comment">//不相等，炸，也就是说a必须等于52</span></span><br><span class="line"> <span class="number">8048</span>c3f:	b8 <span class="number">76</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x76</span>,%eax <span class="comment">//eax=76</span></span><br><span class="line"> <span class="number">8048</span>c44:	e9 b4 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;  <span class="comment">//跳转到cfd,那里比较b和76的大小</span></span><br><span class="line"> <span class="number">8048</span>c49:	b8 <span class="number">64</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x64</span>,%eax <span class="comment">//eax=64</span></span><br><span class="line"> <span class="number">8048</span>c4e:	<span class="number">83</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> <span class="number">73</span>       	cmpl   $<span class="number">0x73</span>,<span class="number">0x28</span>(%esp) <span class="comment">//比较a和73大小</span></span><br><span class="line"> <span class="number">8048</span>c53:	<span class="number">0f</span> <span class="number">84</span> a4 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;  <span class="comment">//相等跳转到cfd,那里比较b和73的大小</span></span><br><span class="line"> <span class="number">8048</span>c59:	e8 <span class="number">58</span> <span class="number">05</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt; <span class="comment">//不相等爆</span></span><br><span class="line"> <span class="number">8048</span>c5e:	b8 <span class="number">64</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x64</span>,%eax <span class="comment">//eax=64</span></span><br><span class="line"> <span class="number">8048</span>c63:	e9 <span class="number">95</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt; <span class="comment">//跳转到cfd,那里比较b和64的大小</span></span><br><span class="line"> <span class="number">8048</span>c68:	b8 <span class="number">6f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x6f</span>,%eax <span class="comment">//eax=6f</span></span><br><span class="line"> <span class="number">8048</span>c6d:	<span class="number">81</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> <span class="number">0b</span> <span class="number">01</span> <span class="number">00</span> 	cmpl   $<span class="number">0x10b</span>,<span class="number">0x28</span>(%esp) <span class="comment">//比较a和10b大小</span></span><br><span class="line"> <span class="number">8048</span>c74:	<span class="number">00</span> </span><br><span class="line"> <span class="number">8048</span>c75:	<span class="number">0f</span> <span class="number">84</span> <span class="number">82</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt; <span class="comment">//相等跳转到cfd,那里比较b和6f的大小</span></span><br><span class="line"> <span class="number">8048</span>c7b:	e8 <span class="number">36</span> <span class="number">05</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt; <span class="comment">//不相等爆</span></span><br><span class="line"> <span class="number">8048</span>c80:	b8 <span class="number">6f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x6f</span>,%eax <span class="comment">//eax=6f</span></span><br><span class="line"> <span class="number">8048</span>c85:	eb <span class="number">76</span>                	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt; <span class="comment">//跳转到cfd,那里比较b和6f的大小</span></span><br><span class="line"> <span class="number">8048</span>c87:	b8 <span class="number">7</span>a <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x7a</span>,%eax <span class="comment">//eax=7a</span></span><br><span class="line"> <span class="number">8048</span>c8c:	<span class="number">81</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> <span class="number">92</span> <span class="number">01</span> <span class="number">00</span> 	cmpl   $<span class="number">0x192</span>,<span class="number">0x28</span>(%esp) <span class="comment">//比较a和192大小</span></span><br><span class="line"> <span class="number">8048</span>c93:	<span class="number">00</span> </span><br><span class="line"> <span class="number">8048</span>c94:	<span class="number">74</span> <span class="number">67</span>                	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt; <span class="comment">//相等跳转到cfd,那里比较b和7a的大小</span></span><br><span class="line"> <span class="number">8048</span>c96:	e8 <span class="number">1b</span> <span class="number">05</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt;<span class="comment">//不相等爆</span></span><br><span class="line"> <span class="number">8048</span>c9b:	b8 <span class="number">7</span>a <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x7a</span>,%eax</span><br><span class="line"> <span class="number">8048</span>ca0:	eb <span class="number">5b</span>                	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;</span><br><span class="line"> <span class="number">8048</span>ca2:	b8 <span class="number">61</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x61</span>,%eax</span><br><span class="line"> <span class="number">8048</span>ca7:	<span class="number">81</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> <span class="number">8</span>e <span class="number">03</span> <span class="number">00</span> 	cmpl   $<span class="number">0x38e</span>,<span class="number">0x28</span>(%esp)</span><br><span class="line"> <span class="number">8048</span>cae:	<span class="number">00</span> </span><br><span class="line"> <span class="number">8048</span>caf:	<span class="number">74</span> <span class="number">4</span>c                	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;</span><br><span class="line"> <span class="number">8048</span>cb1:	e8 <span class="number">00</span> <span class="number">05</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt;</span><br><span class="line"> <span class="number">8048</span>cb6:	b8 <span class="number">61</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x61</span>,%eax</span><br><span class="line"> <span class="number">8048</span>cbb:	eb <span class="number">40</span>                	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;</span><br><span class="line"> <span class="number">8048</span>cbd:	b8 <span class="number">65</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x65</span>,%eax</span><br><span class="line"> <span class="number">8048</span>cc2:	<span class="number">81</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> <span class="number">73</span> <span class="number">02</span> <span class="number">00</span> 	cmpl   $<span class="number">0x273</span>,<span class="number">0x28</span>(%esp)</span><br><span class="line"> <span class="number">8048</span>cc9:	<span class="number">00</span> </span><br><span class="line"> <span class="number">8048</span>cca:	<span class="number">74</span> <span class="number">31</span>                	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;</span><br><span class="line"> <span class="number">8048</span>ccc:	e8 e5 <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt;</span><br><span class="line"> <span class="number">8048</span>cd1:	b8 <span class="number">65</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x65</span>,%eax</span><br><span class="line"> <span class="number">8048</span>cd6:	eb <span class="number">25</span>                	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;</span><br><span class="line"> <span class="number">8048</span>cd8:	b8 <span class="number">79</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x79</span>,%eax</span><br><span class="line"> <span class="number">8048</span>cdd:	<span class="number">81</span> <span class="number">7</span>c <span class="number">24</span> <span class="number">28</span> ad <span class="number">03</span> <span class="number">00</span> 	cmpl   $<span class="number">0x3ad</span>,<span class="number">0x28</span>(%esp)</span><br><span class="line"> <span class="number">8048</span>ce4:	<span class="number">00</span> </span><br><span class="line"> <span class="number">8048</span>ce5:	<span class="number">74</span> <span class="number">16</span>                	je     <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;</span><br><span class="line"> <span class="number">8048</span>ce7:	e8 ca <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt;</span><br><span class="line"> <span class="number">8048</span>cec:	b8 <span class="number">79</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x79</span>,%eax</span><br><span class="line"> <span class="number">8048</span>cf1:	eb <span class="number">0</span>a                	jmp    <span class="number">8048</span>cfd &lt;phase_3+<span class="number">0x141</span>&gt;</span><br><span class="line"> <span class="number">8048</span>cf3:	e8 be <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt; <span class="comment">//爆炸，</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">上面执行的代码大同小异，a必须要等于67\52\73\10b\192\38e\273\3ad这其中的值</span></span><br><span class="line"><span class="comment">分别对应b和66\76\64\6f\7a\61\65\79作比较</span></span><br><span class="line"><span class="comment">否则</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> <span class="number">8048</span>cf8:	b8 <span class="number">62</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x62</span>,%eax</span><br><span class="line"> <span class="number">8048</span>cfd:	<span class="number">3</span>a <span class="number">44</span> <span class="number">24</span> <span class="number">2f</span>          	cmp    <span class="number">0x2f</span>(%esp),%al</span><br><span class="line"> <span class="number">8048</span>d01:	<span class="number">74</span> <span class="number">05</span>                	je     <span class="number">8048</span>d08 &lt;phase_3+<span class="number">0x14c</span>&gt;  <span class="comment">//如果b等于对应eax，那么就跳转</span></span><br><span class="line"> <span class="number">8048</span>d03:	e8 ae <span class="number">04</span> <span class="number">00</span> <span class="number">00</span>       	call   <span class="number">80491b</span>6 &lt;explode_bomb&gt; <span class="comment">//不相等就爆炸，也就是必须相等</span></span><br><span class="line"> <span class="number">8048</span>d08:	<span class="number">83</span> c4 <span class="number">3</span>c             	add    $<span class="number">0x3c</span>,%esp <span class="comment">//d的值(esp+40)再加上0x3c</span></span><br><span class="line"> <span class="number">8048</span>d0b:	c3                   	ret    </span><br><span class="line"></span><br><span class="line"><span class="number">08048</span>d0c &lt;func4&gt;:</span><br><span class="line"> <span class="number">8048</span>d0c:	<span class="number">83</span> ec <span class="number">1</span>c             	sub    $<span class="number">0x1c</span>,%esp   <span class="comment">//这里的栈与原先的栈不同，esp也不同</span></span><br><span class="line"> <span class="number">8048</span>d0f:	<span class="number">89</span> <span class="number">5</span>c <span class="number">24</span> <span class="number">14</span>          	mov    %ebx,<span class="number">0x14</span>(%esp)   <span class="comment">//esp+14=ebx</span></span><br><span class="line"> <span class="number">8048</span>d13:	<span class="number">89</span> <span class="number">74</span> <span class="number">24</span> <span class="number">18</span>          	mov    %esi,<span class="number">0x18</span>(%esp) <span class="comment">//esp+18=esi</span></span><br><span class="line"> <span class="number">8048</span>d17:	<span class="number">8b</span> <span class="number">54</span> <span class="number">24</span> <span class="number">20</span>          	mov    <span class="number">0x20</span>(%esp),%edx  <span class="comment">//edx=esp+20=A</span></span><br><span class="line"> <span class="number">8048</span>d1b:	<span class="number">8b</span> <span class="number">44</span> <span class="number">24</span> <span class="number">24</span>          	mov    <span class="number">0x24</span>(%esp),%eax  <span class="comment">//eax=esp+24=B</span></span><br><span class="line"> <span class="number">8048</span>d1f:	<span class="number">8b</span> <span class="number">5</span>c <span class="number">24</span> <span class="number">28</span>          	mov    <span class="number">0x28</span>(%esp),%ebx  <span class="comment">//ebx=esp+28=C</span></span><br><span class="line"> <span class="number">8048</span>d23:	<span class="number">89</span> d9                	mov    %ebx,%ecx  <span class="comment">//ecx=ebx=C</span></span><br><span class="line"> <span class="number">8048</span>d25:	<span class="number">29</span> c1                	sub    %eax,%ecx  <span class="comment">//C=C-B</span></span><br><span class="line"> <span class="number">8048</span>d27:	<span class="number">89</span> ce                	mov    %ecx,%esi  <span class="comment">//esi=C-B</span></span><br><span class="line"> <span class="number">8048</span>d29:	c1 ee <span class="number">1f</span>             	shr    $<span class="number">0x1f</span>,%esi <span class="comment">//将esi即C-B右移1f位</span></span><br><span class="line"> <span class="number">8048</span>d2c:	<span class="number">01</span> f1                	add    %esi,%ecx  <span class="comment">//ecx=C-B+(C-B)&gt;&gt;1f</span></span><br><span class="line"> <span class="number">8048</span>d2e:	d1 f9                	sar    %ecx  <span class="comment">//ecx=ecx/2=((c-b)+(C-B)&gt;&gt;1f)/2</span></span><br><span class="line"> <span class="number">8048</span>d30:	<span class="number">01</span> c1                	add    %eax,%ecx <span class="comment">//ecx=ecx+B ((c-b)+(C-B)&gt;&gt;1f)/2+B</span></span><br><span class="line"> <span class="number">8048</span>d32:	<span class="number">39</span> d1                	cmp    %edx,%ecx <span class="comment">//比较ecx和A的大小 </span></span><br><span class="line"> <span class="number">8048</span>d34:	<span class="number">7</span>e <span class="number">17</span>                	jle    <span class="number">8048</span>d4d &lt;func4+<span class="number">0x41</span>&gt; <span class="comment">//如果A&lt;=ecx，跳转到d4d</span></span><br><span class="line"> <span class="number">8048</span>d36:	<span class="number">83</span> e9 <span class="number">01</span>             	sub    $<span class="number">0x1</span>,%ecx <span class="comment">//如果A&gt;ecx,ecx-1</span></span><br><span class="line"> <span class="number">8048</span>d39:	<span class="number">89</span> <span class="number">4</span>c <span class="number">24</span> <span class="number">08</span>          	mov    %ecx,<span class="number">0x8</span>(%esp) <span class="comment">//esp+8=ecx</span></span><br><span class="line"> <span class="number">8048</span>d3d:	<span class="number">89</span> <span class="number">44</span> <span class="number">24</span> <span class="number">04</span>          	mov    %eax,<span class="number">0x4</span>(%esp) <span class="comment">//esp+4=B</span></span><br><span class="line"> <span class="number">8048</span>d41:	<span class="number">89</span> <span class="number">14</span> <span class="number">24</span>             	mov    %edx,(%esp)  <span class="comment">//esp=edx=A</span></span><br><span class="line"> <span class="number">8048</span>d44:	e8 c3 ff ff ff       	call   <span class="number">8048</span>d0c &lt;func4&gt; <span class="comment">//递归下一层 fun(A,B,((c-b)+(C-B)&gt;&gt;1f)/2+B-1)</span></span><br><span class="line"> <span class="number">8048</span>d49:	<span class="number">01</span> c0                	add    %eax,%eax <span class="comment">//eax=2B</span></span><br><span class="line"> <span class="number">8048</span>d4b:	eb <span class="number">20</span>                	jmp    <span class="number">8048</span>d6d &lt;func4+<span class="number">0x61</span>&gt; <span class="comment">//跳转到d6d</span></span><br><span class="line"> <span class="number">8048</span>d4d:	b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>       	mov    $<span class="number">0x0</span>,%eax  <span class="comment">//上面说到A&lt;=ecx,这里将eax赋0</span></span><br><span class="line"> <span class="number">8048</span>d52:	<span class="number">39</span> d1                	cmp    %edx,%ecx  <span class="comment">//如果A&gt;=ecx</span></span><br><span class="line"> <span class="number">8048</span>d54:	<span class="number">7</span>d <span class="number">17</span>                	jge    <span class="number">8048</span>d6d &lt;func4+<span class="number">0x61</span>&gt;  <span class="comment">//跳转到d6d，跳出</span></span><br><span class="line"> <span class="number">8048</span>d56:	<span class="number">89</span> <span class="number">5</span>c <span class="number">24</span> <span class="number">08</span>          	mov    %ebx,<span class="number">0x8</span>(%esp) <span class="comment">//esp+8=C</span></span><br><span class="line"> <span class="number">8048</span>d5a:	<span class="number">83</span> c1 <span class="number">01</span>             	add    $<span class="number">0x1</span>,%ecx  <span class="comment">//ecx=ecx+1</span></span><br><span class="line"> <span class="number">8048</span>d5d:	<span class="number">89</span> <span class="number">4</span>c <span class="number">24</span> <span class="number">04</span>          	mov    %ecx,<span class="number">0x4</span>(%esp) <span class="comment">//esp+4=ecx</span></span><br><span class="line"> <span class="number">8048</span>d61:	<span class="number">89</span> <span class="number">14</span> <span class="number">24</span>             	mov    %edx,(%esp)  <span class="comment">//esp=A</span></span><br><span class="line"> <span class="number">8048</span>d64:	e8 a3 ff ff ff       	call   <span class="number">8048</span>d0c &lt;func4&gt; <span class="comment">//fun(A,x,C)</span></span><br><span class="line"> <span class="number">8048</span>d69:	<span class="number">8</span>d <span class="number">44</span> <span class="number">00</span> <span class="number">01</span>          	lea    <span class="number">0x1</span>(%eax,%eax,<span class="number">1</span>),%eax </span><br><span class="line"> <span class="number">8048</span>d6d:	<span class="number">8b</span> <span class="number">5</span>c <span class="number">24</span> <span class="number">14</span>          	mov    <span class="number">0x14</span>(%esp),%ebx  <span class="comment">//上面说到A&lt;=ecx并且B&gt;=ecx,就跳转到这里，跳出函数</span></span><br><span class="line"> <span class="number">8048</span>d71:	<span class="number">8b</span> <span class="number">74</span> <span class="number">24</span> <span class="number">18</span>          	mov    <span class="number">0x18</span>(%esp),%esi  </span><br><span class="line"> <span class="number">8048</span>d75:	<span class="number">83</span> c4 <span class="number">1</span>c             	add    $<span class="number">0x1c</span>,%esp</span><br><span class="line"> <span class="number">8048</span>d78:	c3                   	ret    </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>此时存放的情况应该如下</p>
<p>图一：</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240419210211585.png" alt="image-20240419210211585"></p>
<p>根据上面的分析：</p>
<ol>
<li>密码的排列应该为输入的三个参数的顺序，即<code>c b a</code></li>
<li>c有八种情况，对应的答案应该是一个<code>3*8</code>的矩阵</li>
<li>根据这八种情况来列出答案</li>
</ol>
<p>a必须要等于67\52\73\10b\192\38e\273\3ad这其中的值<br>
分别对应b和66\76\64\6f\7a\61\65\79作比较且必须相等</p>
<p><strong>顺序为c b a</strong></p>
<table>
<thead>
<tr>
<th>c</th>
<th>a</th>
<th>b</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>103</td>
<td>f</td>
</tr>
<tr>
<td>1</td>
<td>82</td>
<td>v</td>
</tr>
<tr>
<td>2</td>
<td>115</td>
<td>d</td>
</tr>
<tr>
<td>3</td>
<td>267</td>
<td>o</td>
</tr>
<tr>
<td>4</td>
<td>402</td>
<td>z</td>
</tr>
<tr>
<td>5</td>
<td>910</td>
<td>a</td>
</tr>
<tr>
<td>6</td>
<td>627</td>
<td>e</td>
</tr>
<tr>
<td>7</td>
<td>941</td>
<td>y</td>
</tr>
</tbody>
</table>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240419214923670.png" alt="image-20240419214923670"></p>
<h3 id="4"><a class="markdownIt-Anchor" href="#4"></a> 4.</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">08048d0c &lt;func4&gt;:</span><br><span class="line"> 8048d0c:	83 ec 1c             	sub    $0x1c,%esp   //这里的栈与原先的栈不同，esp也不同</span><br><span class="line"> 8048d0f:	89 5c 24 14          	mov    %ebx,0x14(%esp)   //esp+14=ebx</span><br><span class="line"> 8048d13:	89 74 24 18          	mov    %esi,0x18(%esp) //esp+18=esi</span><br><span class="line"> 8048d17:	8b 54 24 20          	mov    0x20(%esp),%edx  //edx=esp+20=A</span><br><span class="line"> 8048d1b:	8b 44 24 24          	mov    0x24(%esp),%eax  //eax=esp+24=B</span><br><span class="line"> 8048d1f:	8b 5c 24 28          	mov    0x28(%esp),%ebx  //ebx=esp+28=C</span><br><span class="line"> 8048d23:	89 d9                	mov    %ebx,%ecx  //ecx=ebx=C</span><br><span class="line"> 8048d25:	29 c1                	sub    %eax,%ecx  //C=C-B</span><br><span class="line"> 8048d27:	89 ce                	mov    %ecx,%esi  //esi=C-B</span><br><span class="line"> 8048d29:	c1 ee 1f             	shr    $0x1f,%esi //将esi即C-B右移1f位</span><br><span class="line"> 8048d2c:	01 f1                	add    %esi,%ecx  //ecx=C-B+(C-B)&gt;&gt;1f</span><br><span class="line"> 8048d2e:	d1 f9                	sar    %ecx  //ecx=ecx/2=((c-b)+(C-B)&gt;&gt;1f)/2</span><br><span class="line"> 8048d30:	01 c1                	add    %eax,%ecx //ecx=ecx+B ((c-b)+(C-B)&gt;&gt;1f)/2+B</span><br><span class="line"> 8048d32:	39 d1                	cmp    %edx,%ecx //比较ecx和A的大小 </span><br><span class="line"> 8048d34:	7e 17                	jle    8048d4d &lt;func4+0x41&gt; //如果A&lt;=ecx，跳转到d4d</span><br><span class="line"> 8048d36:	83 e9 01             	sub    $0x1,%ecx //如果A&gt;ecx,ecx-1</span><br><span class="line"> 8048d39:	89 4c 24 08          	mov    %ecx,0x8(%esp) //esp+8=ecx</span><br><span class="line"> 8048d3d:	89 44 24 04          	mov    %eax,0x4(%esp) //esp+4=B</span><br><span class="line"> 8048d41:	89 14 24             	mov    %edx,(%esp)  //esp=edx=A</span><br><span class="line"> 8048d44:	e8 c3 ff ff ff       	call   8048d0c &lt;func4&gt; //递归下一层 fun(A,B,((c-b)+(C-B)&gt;&gt;1f)/2+B-1)</span><br><span class="line"> 8048d49:	01 c0                	add    %eax,%eax //eax=2B</span><br><span class="line"> 8048d4b:	eb 20                	jmp    8048d6d &lt;func4+0x61&gt; //跳转到d6d</span><br><span class="line"> 8048d4d:	b8 00 00 00 00       	mov    $0x0,%eax  //上面说到A&lt;=ecx,这里将eax赋0</span><br><span class="line"> 8048d52:	39 d1                	cmp    %edx,%ecx  //如果A&gt;=ecx</span><br><span class="line"> 8048d54:	7d 17                	jge    8048d6d &lt;func4+0x61&gt;  //跳转到d6d，跳出</span><br><span class="line"> 8048d56:	89 5c 24 08          	mov    %ebx,0x8(%esp) //esp+8=C</span><br><span class="line"> 8048d5a:	83 c1 01             	add    $0x1,%ecx  //ecx=ecx+1</span><br><span class="line"> 8048d5d:	89 4c 24 04          	mov    %ecx,0x4(%esp) //esp+4=ecx</span><br><span class="line"> 8048d61:	89 14 24             	mov    %edx,(%esp)  //esp=A</span><br><span class="line"> 8048d64:	e8 a3 ff ff ff       	call   8048d0c &lt;func4&gt; //fun(A,x,C)</span><br><span class="line"> 8048d69:	8d 44 00 01          	lea    0x1(%eax,%eax,1),%eax </span><br><span class="line"> 8048d6d:	8b 5c 24 14          	mov    0x14(%esp),%ebx  //上面说到A&lt;=ecx并且B&gt;=ecx,就跳转到这里，跳出函数</span><br><span class="line"> 8048d71:	8b 74 24 18          	mov    0x18(%esp),%esi  </span><br><span class="line"> 8048d75:	83 c4 1c             	add    $0x1c,%esp</span><br><span class="line"> 8048d78:	c3                   	ret    </span><br><span class="line"></span><br><span class="line">08048d79 &lt;phase_4&gt;:</span><br><span class="line"> 8048d79:	83 ec 2c             	sub    $0x2c,%esp  //esp减去2c</span><br><span class="line"> 8048d7c:	8d 44 24 1c          	lea    0x1c(%esp),%eax  //eax=esp+1c=a </span><br><span class="line"> 8048d80:	89 44 24 0c          	mov    %eax,0xc(%esp) //esp+c=eax=a</span><br><span class="line"> 8048d84:	8d 44 24 18          	lea    0x18(%esp),%eax  //eax=esp+18=b</span><br><span class="line"> 8048d88:	89 44 24 08          	mov    %eax,0x8(%esp)  //esp+8=eax=b</span><br><span class="line"> 8048d8c:	c7 44 24 04 a3 a4 04 	movl   $0x804a4a3,0x4(%esp)  //esp+4=这个立即数</span><br><span class="line"> 8048d93:	08 </span><br><span class="line"> 8048d94:	8b 44 24 30          	mov    0x30(%esp),%eax  //eax=esp+30=c</span><br><span class="line"> 8048d98:	89 04 24             	mov    %eax,(%esp)  //esp=c</span><br><span class="line"> 8048d9b:	e8 d0 fa ff ff       	call   8048870 &lt;__isoc99_sscanf@plt&gt; //输入几个参数，也就是b,a</span><br><span class="line"> 8048da0:	83 f8 02             	cmp    $0x2,%eax  //比较eax和2，判断输入是否完成</span><br><span class="line"> 8048da3:	75 0d                	jne    8048db2 &lt;phase_4+0x39&gt; //输入未完成跳转到db2，也就是爆炸 </span><br><span class="line"> 8048da5:	8b 44 24 18          	mov    0x18(%esp),%eax   //eax=esp+18=b</span><br><span class="line"> 8048da9:	85 c0                	test   %eax,%eax  //eax是否为0</span><br><span class="line"> 8048dab:	78 05                	js     8048db2 &lt;phase_4+0x39&gt;  //SF为1，eax为0时跳转到爆炸</span><br><span class="line"> 8048dad:	83 f8 0e             	cmp    $0xe,%eax //比较eax和e</span><br><span class="line"> 8048db0:	7e 05                	jle    8048db7 &lt;phase_4+0x3e&gt;  //如果eax&lt;=e,跳转到db7</span><br><span class="line"> 8048db2:	e8 ff 03 00 00       	call   80491b6 &lt;explode_bomb&gt; //如果大于e，就爆炸，也就是eax必须小于等于e，也就是b必须小于等于e</span><br><span class="line"> 8048db7:	c7 44 24 08 0e 00 00 	movl   $0xe,0x8(%esp)  //前面提到eax&lt;=e,那么b就设置为e</span><br><span class="line"> 8048dbe:	00 </span><br><span class="line"> 8048dbf:	c7 44 24 04 00 00 00 	movl   $0x0,0x4(%esp)  //esp+4置为0</span><br><span class="line"> 8048dc6:	00 </span><br><span class="line"> 8048dc7:	8b 44 24 18          	mov    0x18(%esp),%eax  //eax=原先b的值</span><br><span class="line"> 8048dcb:	89 04 24             	mov    %eax,(%esp) //esp=源b</span><br><span class="line"> 8048dce:	e8 39 ff ff ff       	call   8048d0c &lt;func4&gt;  //调用func4，三个参数分别为b，0，e</span><br><span class="line"> 8048dd3:	85 c0                	test   %eax,%eax //判断返回值是否为0</span><br><span class="line"> 8048dd5:	75 07                	jne    8048dde &lt;phase_4+0x65&gt;  //不为0，就跳转到dde，就是爆炸</span><br><span class="line"> 8048dd7:	83 7c 24 1c 00       	cmpl   $0x0,0x1c(%esp) //也就是返回值必须等于0，比较a和0的值</span><br><span class="line"> 8048ddc:	74 05                	je     8048de3 &lt;phase_4+0x6a&gt; //如果a=0.那么就跳转到de3，跳出</span><br><span class="line"> 8048dde:	e8 d3 03 00 00       	call   80491b6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048de3:	83 c4 2c             	add    $0x2c,%esp</span><br><span class="line"> 8048de6:	c3                   	ret    </span><br></pre></td></tr></table></figure>
<p>func可能的c语言代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func4</span><span class="params">(<span class="type">int</span> A, <span class="type">int</span> B, <span class="type">int</span> C)</span> &#123;</span><br><span class="line">    <span class="type">int</span> result = (C - B + ((C - B) &gt;&gt; <span class="number">0x1F</span>)) / <span class="number">2</span> + B;</span><br><span class="line">    <span class="keyword">if</span> (A &lt;= result) &#123;</span><br><span class="line">        <span class="keyword">if</span> (A &gt;= result) &#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        result++;</span><br><span class="line">        func4(A, result, C);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result--;</span><br><span class="line">        func4(A, B, result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也就是result最后必须为0跳出，可得A参数即b的值应该是0，那么a的值也是0.</p>
<p>密码应该是0，0；</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220303281.png" alt="image-20240422220303281"></p>
<h3 id="5"><a class="markdownIt-Anchor" href="#5"></a> 5.</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">08048de7 &lt;phase_5&gt;:</span><br><span class="line"> 8048de7:	83 ec 2c             	sub    $0x2c,%esp    //开辟栈空间</span><br><span class="line"> 8048dea:	8d 44 24 1c          	lea    0x1c(%esp),%eax 	//eax=esp+1c=a</span><br><span class="line"> 8048dee:	89 44 24 0c          	mov    %eax,0xc(%esp)		//esp+c=esp+1c</span><br><span class="line"> 8048df2:	8d 44 24 18          	lea    0x18(%esp),%eax	//eax=esp+18</span><br><span class="line"> 8048df6:	89 44 24 08          	mov    %eax,0x8(%esp)		//esp+8=eax=esp+18=b</span><br><span class="line"> 8048dfa:	c7 44 24 04 a3 a4 04 	movl   $0x804a4a3,0x4(%esp) //存入这个立即数</span><br><span class="line"> 8048e01:	08 </span><br><span class="line"> 8048e02:	8b 44 24 30          	mov    0x30(%esp),%eax		</span><br><span class="line"> 8048e06:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048e09:	e8 62 fa ff ff       	call   8048870 &lt;__isoc99_sscanf@plt&gt;  //这里进行输入操作并判断输入是否完成</span><br><span class="line"> 8048e0e:	83 f8 01             	cmp    $0x1,%eax		</span><br><span class="line"> 8048e11:	7f 05                	jg     8048e18 &lt;phase_5+0x31&gt;		//这里表明至少输入了2个数</span><br><span class="line"> 8048e13:	e8 9e 03 00 00       	call   80491b6 &lt;explode_bomb&gt;	//输入未完成就爆炸</span><br><span class="line"> 8048e18:	8b 44 24 18          	mov    0x18(%esp),%eax	//eax=esp+18=b</span><br><span class="line"> 8048e1c:	83 e0 0f             	and    $0xf,%eax		//eax=eax&amp;f=b&amp;0xf</span><br><span class="line"> 8048e1f:	89 44 24 18          	mov    %eax,0x18(%esp) 		//将得到的与结果num1存入原b的位置</span><br><span class="line"> 8048e23:	83 f8 0f             	cmp    $0xf,%eax		//eax与num1比较</span><br><span class="line"> 8048e26:	74 2a                	je     8048e52 &lt;phase_5+0x6b&gt;		//如果num1==0xf</span><br><span class="line"> 8048e28:	b9 00 00 00 00       	mov    $0x0,%ecx		//ecx=0</span><br><span class="line"> 8048e2d:	ba 00 00 00 00       	mov    $0x0,%edx		//edx=0</span><br><span class="line"> 8048e32:	83 c2 01             	add    $0x1,%edx		//edx++ -&gt;edx=1</span><br><span class="line"> 8048e35:	8b 04 85 00 a3 04 08 	mov    0x804a300(,%eax,4),%eax	//eax=804a300+4*eax</span><br><span class="line"> 8048e3c:	01 c1                	add    %eax,%ecx		//ecx=eax+0=804a300+4*num1</span><br><span class="line"> 8048e3e:	83 f8 0f             	cmp    $0xf,%eax	//eax和f比较</span><br><span class="line"> 8048e41:	75 ef                	jne    8048e32 &lt;phase_5+0x4b&gt;		</span><br><span class="line"> /*</span><br><span class="line"> 如果eax和f不相等，跳转到e32,这里表明他进入了一个循环，</span><br><span class="line"> 因此eax结束时，他的值应该是15</span><br><span class="line"> */</span><br><span class="line"> 8048e43:	89 44 24 18          	mov    %eax,0x18(%esp)		//原来b的位置放入eax的值</span><br><span class="line"> 8048e47:	83 fa 0f             	cmp    $0xf,%edx		//edx和f比较</span><br><span class="line"> 8048e4a:	75 06                	jne    8048e52 &lt;phase_5+0x6b&gt;		//如果edx不等于f，跳转到爆炸，</span><br><span class="line"> 8048e4c:	3b 4c 24 1c          	cmp    0x1c(%esp),%ecx	//比较a和ecx的值</span><br><span class="line"> 8048e50:	74 05                	je     8048e57 &lt;phase_5+0x70&gt;		//如果相等跳转e57，跳出</span><br><span class="line"> 8048e52:	e8 5f 03 00 00       	call   80491b6 &lt;explode_bomb&gt;	</span><br><span class="line"> 8048e57:	83 c4 2c             	add    $0x2c,%esp	//跳出</span><br><span class="line"> 8048e5a:	c3                   	ret    </span><br></pre></td></tr></table></figure>
<p>这里最主要的是循环结构，根据对汇编代码的分析，可以发现这个循环进行的次数为15，并且最终eax中存放的值应该为15，每次eax的值都符合</p>
<p><code>eax=arr[eax]</code>；</p>
<p>最终参数a的值应该是所有数组arr的值相加，由循环后的代码可得</p>
<p>而参数b的值对应的是arr数组的初始值，或者说是开始循环时arr[b]中的b；</p>
<p>这需要根据arr[n]=15和gdb来得到</p>
<p>使用gdb指令：<code>x/16dh 0x804a300</code>来查看数组中的每个数据</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422115323390.png" alt="image-20240422115323390"></p>
<p>所以arr数组为：</p>
<p>0x804a300 &lt;array.2957&gt;:	   10	2	14	7<br>
0x804a310 &lt;array.2957+16&gt;:	8	12	15	11<br>
0x804a320 &lt;array.2957+32&gt;:	0	4	1	13<br>
0x804a330 &lt;array.2957+48&gt;:	3	9	6	5</p>
<p>那么 <code>arr[6]=15</code></p>
<p>arr[14]=6;</p>
<p>arr[2]=14;</p>
<p>arr[1]=2;</p>
<p>arr[10]=1;</p>
<p>arr[0]=10;</p>
<p>arr[8]=0;</p>
<p>arr[4]=8;</p>
<p>arr[9]=4;</p>
<p>arr[13]=9;</p>
<p>arr[11]=13;</p>
<p>arr[7]=11;</p>
<p>arr[3]=7;</p>
<p>arr[12]=3;</p>
<p>arr[5]=12;</p>
<p>所以最终可以得到b=5;a=115；</p>
<p>密码应该是5,115;</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220322775.png" alt="image-20240422220322775"></p>
<h3 id="6"><a class="markdownIt-Anchor" href="#6"></a> 6.</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">08048e5b &lt;phase_6&gt;:</span><br><span class="line"> 8048e5b:	56                   	push   %esi</span><br><span class="line"> 8048e5c:	53                   	push   %ebx</span><br><span class="line"> 8048e5d:	83 ec 44             	sub    $0x44,%esp		</span><br><span class="line"> /*</span><br><span class="line"> 保存源基址并开辟新的内存空间</span><br><span class="line"> */</span><br><span class="line"> 8048e60:	8d 44 24 10          	lea    0x10(%esp),%eax</span><br><span class="line"> 8048e64:	89 44 24 04          	mov    %eax,0x4(%esp)</span><br><span class="line"> /*</span><br><span class="line"> esp+4的位置放上esp+10=a</span><br><span class="line"> */</span><br><span class="line"> 8048e68:	8b 44 24 50          	mov    0x50(%esp),%eax</span><br><span class="line"> 8048e6c:	89 04 24             	mov    %eax,(%esp)		//esp的位置放上esp+50=b</span><br><span class="line"> 8048e6f:	e8 77 04 00 00       	call   80492eb &lt;read_six_numbers&gt;   //这里读六个数字</span><br><span class="line"> 8048e74:	be 00 00 00 00       	mov    $0x0,%esi		</span><br><span class="line"> 8048e79:	8b 44 b4 10          	mov    0x10(%esp,%esi,4),%eax			//eax=4*0+esp+10=esp+10=10+b，esi为0表示6个数中的第0个</span><br><span class="line"> 8048e7d:	83 e8 01             	sub    $0x1,%eax			//eax-=1-&gt; eax=esp+9=9+b;</span><br><span class="line"> 8048e80:	83 f8 05             	cmp    $0x5,%eax			//将9+b和eax比较，这里表明eax的值必为1-6</span><br><span class="line"> 8048e83:	76 05                	jbe    8048e8a &lt;phase_6+0x2f&gt;			//如果9+b&lt;=5，那么跳转到e8a</span><br><span class="line"> 8048e85:	e8 2c 03 00 00       	call   80491b6 &lt;explode_bomb&gt;		//这里证明9+b必须&lt;=5</span><br><span class="line"> /*</span><br><span class="line"> 这里可以得出输入的数在1-6之间</span><br><span class="line"> */</span><br><span class="line"> 8048e8a:	83 c6 01             	add    $0x1,%esi		//esi++ -&gt; esi=1`</span><br><span class="line"> 8048e8d:	83 fe 06             	cmp    $0x6,%esi		//esi和6比较</span><br><span class="line"> 8048e90:	74 1b                	je     8048ead &lt;phase_6+0x52&gt;			//如果等于6，跳转到ead</span><br><span class="line"> 8048e92:	89 f3                	mov    %esi,%ebx			//如果不等于6;ebx=esi的值=1</span><br><span class="line"> 8048e94:	8b 44 9c 10          	mov    0x10(%esp,%ebx,4),%eax		//eax=4ebx+b+10</span><br><span class="line"> 8048e98:	39 44 b4 0c          	cmp    %eax,0xc(%esp,%esi,4)		//比较4esi+b+c(12)的值和4esi+b+10的值</span><br><span class="line"> 8048e9c:	75 05                	jne    8048ea3 &lt;phase_6+0x48&gt;		//如果不相等，就跳转到ea3</span><br><span class="line"> 8048e9e:	e8 13 03 00 00       	call   80491b6 &lt;explode_bomb&gt;		//如果相等，爆炸</span><br><span class="line"> 8048ea3:	83 c3 01             	add    $0x1,%ebx		//ebx++ -&gt;esi++ebx=2</span><br><span class="line"> 8048ea6:	83 fb 05             	cmp    $0x5,%ebx		//比较ebx和5</span><br><span class="line"> 8048ea9:	7e e9                	jle    8048e94 &lt;phase_6+0x39&gt;		//如果ebx&lt;=5,跳转到e94,这里进入了一个循环</span><br><span class="line"> 8048eab:	eb cc                	jmp    8048e79 &lt;phase_6+0x1e&gt;		//这里跳转到e79，进入了下一轮循环</span><br><span class="line"> 8048ead:	8d 44 24 10          	lea    0x10(%esp),%eax		//eax=esp+10</span><br><span class="line"> 8048eb1:	8d 5c 24 28          	lea    0x28(%esp),%ebx		//ebx=esp+28</span><br><span class="line"> 8048eb5:	b9 07 00 00 00       	mov    $0x7,%ecx		//ecx=7</span><br><span class="line"> 8048eba:	89 ca                	mov    %ecx,%edx		//edx=ecx=7  </span><br><span class="line"> /*</span><br><span class="line"> 这里表明最终的顺序是7-x的值</span><br><span class="line"> */</span><br><span class="line"> 8048ebc:	2b 10                	sub    (%eax),%edx		//edx-=esp+10中的值</span><br><span class="line"> 8048ebe:	89 10                	mov    %edx,(%eax)		//eax存放的地址放入edx的值即edx-=(esp+10)</span><br><span class="line"> 8048ec0:	83 c0 04             	add    $0x4,%eax			//eax+=4=(esp+10)+4</span><br><span class="line"> 8048ec3:	39 d8                	cmp    %ebx,%eax			//比较eax和esp+28存放的值</span><br><span class="line"> 8048ec5:	75 f3                	jne    8048eba &lt;phase_6+0x5f&gt;		//如果这两个数字不相等，跳转到eba</span><br><span class="line"> 8048ec7:	bb 00 00 00 00       	mov    $0x0,%ebx			//如果相等了，ebx=0</span><br><span class="line"> 8048ecc:	eb 16                	jmp    8048ee4 &lt;phase_6+0x89&gt;		//跳转到ee4</span><br><span class="line"> 8048ece:	8b 52 08             	mov    0x8(%edx),%edx			//edx=edx+8</span><br><span class="line"> 8048ed1:	83 c0 01             	add    $0x1,%eax		//eax++</span><br><span class="line"> 8048ed4:	39 c8                	cmp    %ecx,%eax  //比较eax和ecx的值</span><br><span class="line"> 8048ed6:	75 f6                	jne    8048ece &lt;phase_6+0x73&gt;			//如果eax不等于ecx，循环</span><br><span class="line"> 8048ed8:	89 54 b4 28          	mov    %edx,0x28(%esp,%esi,4)			//esp+4esi+28的值等于edx</span><br><span class="line"> 8048edc:	83 c3 01             	add    $0x1,%ebx		//ebx++</span><br><span class="line"> 8048edf:	83 fb 06             	cmp    $0x6,%ebx		//ebx和6比较</span><br><span class="line"> 8048ee2:	74 17                	je     8048efb &lt;phase_6+0xa0&gt;		//如果ebx=6，跳转到efb</span><br><span class="line"> 8048ee4:	89 de                	mov    %ebx,%esi		//如果不相等esi=ebx</span><br><span class="line"> 8048ee6:	8b 4c 9c 10          	mov    0x10(%esp,%ebx,4),%ecx			//ecx的值=4ebx+esp+10</span><br><span class="line"> 8048eea:	b8 01 00 00 00       	mov    $0x1,%eax			ea=10</span><br><span class="line"></span><br><span class="line"> 8048eef:	ba 3c c1 04 08       	mov    $0x804c13c,%edx		//edx放入这个地址</span><br><span class="line"> 8048ef4:	83 f9 01             	cmp    $0x1,%ecx		//比较ecx和1的大小</span><br><span class="line"> 8048ef7:	7f d5                	jg     8048ece &lt;phase_6+0x73&gt;		//如果ecx&gt;1，跳转到ece</span><br><span class="line"> 8048ef9:	eb dd                	jmp    8048ed8 &lt;phase_6+0x7d&gt;		//如果没有就跳转到ed8</span><br><span class="line"> 8048efb:	8b 5c 24 28          	mov    0x28(%esp),%ebx		//当ebx=6是跳转到这里,ebx=esp+28</span><br><span class="line"> 8048eff:	8b 44 24 2c          	mov    0x2c(%esp),%eax		</span><br><span class="line"> 8048f03:	89 43 08             	mov    %eax,0x8(%ebx)		//ebx+8=esp+2c</span><br><span class="line"> 8048f06:	8b 54 24 30          	mov    0x30(%esp),%edx		</span><br><span class="line"> 8048f0a:	89 50 08             	mov    %edx,0x8(%eax)		//eax+8=esp+30</span><br><span class="line"> 8048f0d:	8b 44 24 34          	mov    0x34(%esp),%eax</span><br><span class="line"> 8048f11:	89 42 08             	mov    %eax,0x8(%edx)		//edx+8=esp+34</span><br><span class="line"> 8048f14:	8b 54 24 38          	mov    0x38(%esp),%edx</span><br><span class="line"> 8048f18:	89 50 08             	mov    %edx,0x8(%eax)		//eax+8=esp+38</span><br><span class="line"> 8048f1b:	8b 44 24 3c          	mov    0x3c(%esp),%eax</span><br><span class="line"> 8048f1f:	89 42 08             	mov    %eax,0x8(%edx)		//edx+8=3c</span><br><span class="line"> 8048f22:	c7 40 08 00 00 00 00 	movl   $0x0,0x8(%eax)		//eax+8=0</span><br><span class="line"> 8048f29:	be 05 00 00 00       	mov    $0x5,%esi		//esi=5</span><br><span class="line">/*</span><br><span class="line">这里貌似是将链表中的节点按照输入的6个数字进行调换， 最终的节点顺序按照输入的6个数字来</span><br><span class="line">*/</span><br><span class="line"> 8048f2e:	8b 43 08             	mov    0x8(%ebx),%eax		//eax=ebx+8</span><br><span class="line"> 8048f31:	8b 10                	mov    (%eax),%edx		//edx=eax的值</span><br><span class="line"> 8048f33:	39 13                	cmp    %edx,(%ebx)		//比较ebx的值和edx</span><br><span class="line"> 8048f35:	7d 05                	jge    8048f3c &lt;phase_6+0xe1&gt;		//如果ebx的值&gt;=edx也就是ebx+8的值，跳转到f3c</span><br><span class="line"> 8048f37:	e8 7a 02 00 00       	call   80491b6 &lt;explode_bomb&gt;		//否则爆炸</span><br><span class="line"> 8048f3c:	8b 5b 08             	mov    0x8(%ebx),%ebx</span><br><span class="line"> 8048f3f:	83 ee 01             	sub    $0x1,%esi</span><br><span class="line"> 8048f42:	75 ea                	jne    8048f2e &lt;phase_6+0xd3&gt;   //循环跳转到f2e，</span><br><span class="line">/*</span><br><span class="line">这里实际上是对链表中的节点进行判断，如果存在两个节点不是递减，那么就会爆炸</span><br><span class="line">这一段代码表明最终这六个数应该是递减的</span><br><span class="line">*/</span><br><span class="line"> 8048f44:	83 c4 44             	add    $0x44,%esp</span><br><span class="line"> 8048f47:	5b                   	pop    %ebx</span><br><span class="line"> 8048f48:	5e                   	pop    %esi</span><br><span class="line"> 8048f49:	c3                   	ret    </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">8048e74:	be 00 00 00 00       	mov    $0x0,%esi		</span><br><span class="line">8048e79:	8b 44 b4 10          	mov    0x10(%esp,%esi,4),%eax			//eax=4*0+esp+10=esp+10=10+b，esi为0表示6个数中的第0个</span><br><span class="line">8048e7d:	83 e8 01             	sub    $0x1,%eax			//eax-=1-&gt; eax=esp+9=9+b;</span><br><span class="line">8048e80:	83 f8 05             	cmp    $0x5,%eax			//将9+b和eax比较，这里表明eax的值必为1-6</span><br><span class="line">8048e83:	76 05                	jbe    8048e8a &lt;phase_6+0x2f&gt;			//如果9+b&lt;=5，那么跳转到e8a</span><br><span class="line">8048e85:	e8 2c 03 00 00       	call   80491b6 &lt;explode_bomb&gt;		//这里证明9+b必须&lt;=5</span><br></pre></td></tr></table></figure>
<p>在前面的代码中，得知输入的六个数应该在1-6之间。</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422210043013.png" alt="image-20240422210043013"></p>
<p>这里可以发现</p>
<p><code>8048eef:	ba 3c c1 04 08       	mov    $0x804c13c,%edx		//edx放入这个地址</code></p>
<p>这里实际上是开始对一个链表的第一个节点开始进行操作</p>
<p>用gdb指令查看这个地址以及周边地址的相关信息</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/C:%5CUsers%5C%E5%8D%97%E6%B8%A1%E7%9A%84%E5%8D%97%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240422220559005.png" alt="image-20240422220559005"></p>
<p>然后根据这个节点所指向的下一个节点的地址来继续迭代查看可以发现</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422220523054.png" alt="image-20240422220523054"></p>
<p>所以节点1-6的值分别为(十六进制)：<br>
<code>388,265,1e8,42,143,1bc</code></p>
<p>然后，通过分析，最终交换之后的链表的值应该递减，因此可以按照这六个节点的值来反向推断出应该对调完成的顺序</p>
<p><code>1 2 3 6 5 4</code></p>
<p>再用7减去</p>
<p><code>6 5 4 1 2 3</code></p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240422224007580.png" alt="image-20240422224007580"></p>
<h3 id="secret_phase"><a class="markdownIt-Anchor" href="#secret_phase"></a> secret_phase</h3>
<h4 id="在phase_defused中"><a class="markdownIt-Anchor" href="#在phase_defused中"></a> 在phase_defused中</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">8049356:	8d 44 24 2c          	lea    0x2c(%esp),%eax</span><br><span class="line">804935a:	89 44 24 10          	mov    %eax,0x10(%esp)</span><br><span class="line">804935e:	8d 44 24 28          	lea    0x28(%esp),%eax</span><br><span class="line">8049362:	89 44 24 0c          	mov    %eax,0xc(%esp)</span><br><span class="line">8049366:	8d 44 24 24          	lea    0x24(%esp),%eax</span><br><span class="line">804936a:	89 44 24 08          	mov    %eax,0x8(%esp)</span><br><span class="line">804936e:	c7 44 24 04 a9 a4 04 	movl   $0x804a4a9,0x4(%esp)</span><br></pre></td></tr></table></figure>
<p>这里实际上输入了三个参数，通过gdb命令查看，可以发现这三个参数满足</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425161836713.png" alt="image-20240425161836713"></p>
<p>也就是说需要输入的参数分别为int,int和string</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8049376:	c7 04 24 d0 c4 04 08 	movl   $0x804c4d0,(%esp)</span><br></pre></td></tr></table></figure>
<p>通过gdb命令调试得到前两个参数为</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425163713343.png" alt="image-20240425163713343"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">8049387:	c7 44 24 04 b2 a4 04 	movl   $0x804a4b2,0x4(%esp)</span><br><span class="line"> 804938e:	08 </span><br><span class="line"> 804938f:	8d 44 24 2c          	lea    0x2c(%esp),%eax</span><br><span class="line"> 8049393:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> /*</span><br><span class="line"> esp+2c表示的地址存放在esp中存放的地址，即804c4d0</span><br><span class="line"> */</span><br><span class="line"> 8049396:	e8 09 fd ff ff       	call   80490a4 &lt;strings_not_equal&gt;</span><br><span class="line"> 804939b:	85 c0                	test   %eax,%eax			//判断eax中的字符串是否等于esp+4的地址的值</span><br><span class="line"> 804939d:	75 1d                	jne    80493bc &lt;phase_defused+0x81&gt;			//如果不相等，跳转到bc</span><br></pre></td></tr></table></figure>
<p>这里对eax和某个地址存放的值进行了，比较，经过gdb调试，发现是第三个参数，值为&quot;DrEvil&quot;</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425162039022.png" alt="image-20240425162039022"></p>
<p>判断字符串相等后接下来又发现了一个地址，使用gdb调试发现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">804939f:	c7 04 24 78 a3 04 08 	movl   $0x804a378,(%esp)			//相等，继续判断</span><br><span class="line">80493a6:	e8 55 f4 ff ff       	call   8048800 &lt;puts@plt&gt;		//</span><br><span class="line">80493ab:	c7 04 24 a0 a3 04 08 	movl   $0x804a3a0,(%esp)</span><br><span class="line">80493b2:	e8 49 f4 ff ff       	call   8048800 &lt;puts@plt&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425162823116.png" alt="image-20240425162823116"></p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425162908608.png" alt="image-20240425162908608"></p>
<p>这里表明成功进入了serect_phase。</p>
<p>所以最终的进入serect的方法就是在第四个答案后加入 “DrEvil”</p>
<h4 id="在serect_phase函数中"><a class="markdownIt-Anchor" href="#在serect_phase函数中"></a> 在serect_phase函数中</h4>
<p>实际上最重要的就是这几句代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">8048fd8:	e8 6d ff ff ff       	call   8048f4a &lt;fun7&gt;			//func进入(804c088,num)</span><br><span class="line">8048fdd:	83 f8 05             	cmp    $0x5,%eax			//比较函数返回值和5</span><br><span class="line">8048fe0:	74 05                	je     8048fe7 &lt;secret_phase+0x4c&gt;			//如果相等，跳转到fe7</span><br><span class="line">8048fe2:	e8 cf 01 00 00       	call   80491b6 &lt;explode_bomb&gt;			//这里说明返回值只能是5</span><br></pre></td></tr></table></figure>
<p>这里给出我们调用func7函数后返回值只能是5,由此可以逆推</p>
<h4 id="在func7函数中"><a class="markdownIt-Anchor" href="#在func7函数中"></a> 在func7函数中</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">08048f4a &lt;fun7&gt;:</span><br><span class="line"> 8048f4a:	53                   	push   %ebx</span><br><span class="line"> 8048f4b:	83 ec 18             	sub    $0x18,%esp</span><br><span class="line"> 8048f4e:	8b 54 24 20          	mov    0x20(%esp),%edx			//参数一是地址0x804c088</span><br><span class="line"> 8048f52:	8b 4c 24 24          	mov    0x24(%esp),%ecx			//参数二是num</span><br><span class="line"> 8048f56:	85 d2                	test   %edx,%edx			//edx是否为0</span><br><span class="line"> 8048f58:	74 37                	je     8048f91 &lt;fun7+0x47&gt;			为0跳转到f91</span><br><span class="line"> 8048f5a:	8b 1a                	mov    (%edx),%ebx			//不为0继续执行，ebx的值为edx的地址存放的值</span><br><span class="line"> 8048f5c:	39 cb                	cmp    %ecx,%ebx		//比较edx和ecx</span><br><span class="line"> /*</span><br><span class="line"> 这里可以看作是二叉树搜索，如果给定的值num &lt;= 当前节点的值，</span><br><span class="line"> 就跳转到对应的代码中执行</span><br><span class="line"> */</span><br><span class="line"> 8048f5e:	7e 13                	jle    8048f73 &lt;fun7+0x29&gt;		//如果ecx&lt;=edx，跳转到f73</span><br><span class="line"> 8048f60:	89 4c 24 04          	mov    %ecx,0x4(%esp)			//如果ecx&gt;edx，esp+4=ecx=num</span><br><span class="line"> 8048f64:	8b 42 04             	mov    0x4(%edx),%eax		//eax=804c092的值</span><br><span class="line"> 8048f67:	89 04 24             	mov    %eax,(%esp)		//esp指向的地址=804c092</span><br><span class="line"> 8048f6a:	e8 db ff ff ff       	call   8048f4a &lt;fun7&gt;		//递归(804c092,num)</span><br><span class="line"> /*</span><br><span class="line"> 这里是一种情况的递归</span><br><span class="line">其中当num&gt;node-&gt;value时，执行此段代码，最终node=node-&gt;rightChild,并进入下一层递归</span><br><span class="line"> */</span><br><span class="line"> 8048f6f:	01 c0                	add    %eax,%eax		//eax*=2，其中eax作为递归的返回值</span><br><span class="line"> 8048f71:	eb 23                	jmp    8048f96 &lt;fun7+0x4c&gt;		//跳转到f96，跳出,此时e返回值为2倍返回值</span><br><span class="line"> /*</span><br><span class="line"> 第一种情况递归返回2倍递归返回值</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"> 8048f73:	b8 00 00 00 00       	mov    $0x0,%eax		//eax=0	这里对应num&lt;=node-&gt;value的情况</span><br><span class="line"> 8048f78:	39 cb                	cmp    %ecx,%ebx		//比较ebx和ecx</span><br><span class="line"> 8048f7a:	74 1a                	je     8048f96 &lt;fun7+0x4c&gt;				//如果相等，跳转到f96，跳出函数，此时eax=0，</span><br><span class="line"> /*</span><br><span class="line"> 这里说明已经找到了该值，返回0</span><br><span class="line"> */</span><br><span class="line"> 8048f7c:	89 4c 24 04          	mov    %ecx,0x4(%esp)			//如果不相等，esp+4=ecx=num</span><br><span class="line"> 8048f80:	8b 42 08             	mov    0x8(%edx),%eax			//eax=804c096</span><br><span class="line"> 8048f83:	89 04 24             	mov    %eax,(%esp)				//存放在(esp)</span><br><span class="line"> 8048f86:	e8 bf ff ff ff       	call   8048f4a &lt;fun7&gt;		</span><br><span class="line"> /*</span><br><span class="line"> 这里完成了一次递归，其中node的地址加上了8，说明这里递归时参数为node-&gt;leftChild,num</span><br><span class="line"> */</span><br><span class="line"> 8048f8b:	8d 44 00 01          	lea    0x1(%eax,%eax,1),%eax		//eax=2倍返回值+1</span><br><span class="line"> 8048f8f:	eb 05                	jmp    8048f96 &lt;fun7+0x4c&gt;	//此时返回</span><br><span class="line"> /*</span><br><span class="line"> &lt;=情况返回两倍递归返回值+1</span><br><span class="line"> */</span><br><span class="line"> 8048f91:	b8 ff ff ff ff       	mov    $0xffffffff,%eax		//eax=0xffffffff,返回，后面要求返回值是5，这里应该是要求不应该跳转到这</span><br><span class="line"> 8048f96:	83 c4 18             	add    $0x18,%esp</span><br><span class="line"> 8048f99:	5b                   	pop    %ebx</span><br><span class="line"> 8048f9a:	c3                   	ret    </span><br></pre></td></tr></table></figure>
<p>这里实际上就是一个在二叉树中查找某一个数的操作，对应的c代码为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">leftChild</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">rightChild</span>;</span></span><br><span class="line">&#125; Node;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">fun7</span><span class="params">(Node *node, <span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (node == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> value = node-&gt;value;</span><br><span class="line">    <span class="keyword">if</span> (num &lt;= value) &#123;</span><br><span class="line">        <span class="keyword">if</span> (num == value) </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> result = fun7(node-&gt;leftChild, num);</span><br><span class="line">            <span class="keyword">if</span> (result != <span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">2</span> * result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">int</span> result = fun7(node-&gt;rightChild, num);</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="number">-1</span>) </span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span> * result + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用gdb调试查看node的地址</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425173820150.png" alt="image-20240425173820150"></p>
<p>可以画出这棵二叉树</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425174146868.png" alt="image-20240425174146868"></p>
<p>接下来就是要使其返回值为5</p>
<p>易得其回溯的过程应该为：res=0,res=2$\times<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>r</mi><mi>e</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0+1,res=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>\times<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo separator="true">,</mo><mi>r</mi><mi>e</mi><mi>s</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2,res=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>\times$2+1</p>
<p>那么其需要找的值就是2f,也就是十进制的47</p>
<p><img src="/2024/04/Bomb%E5%AE%9E%E9%AA%8C/image-20240425174444806.png" alt="image-20240425174444806"></p>
<h2 id="五-实验总结"><a class="markdownIt-Anchor" href="#五-实验总结"></a> 五、实验总结</h2>
<ol>
<li>通过拆除炸弹这种寓教于乐的方式，进一步加深了对汇编代码的理解；</li>
<li>对switch,链表，树等等结构都从汇编的层面上加深了印象，也了解了这些结构在汇编层面是如何实现的，进一步认识到开发者对于数据结构设计和开发的想法之妙和功底之深；</li>
<li>在网络上查阅了大量的相关资料，学习到了一些先进的解题方法和思想并将其应用于解题之中；</li>
<li>与同学、老师进行深入的探讨，从而加快了对于题目的理解及解题速度。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ycx6666.github.io/2024/04/Bomb%E5%AE%9E%E9%AA%8C/" data-id="clvgrsp330004wsmcgwzr5k18" data-title="Bomb Lab实验" class="article-share-link">分享</a>
      
      
      
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%9E%E9%AA%8C/" rel="tag">实验</a></li></ul>


    </footer>
  </div>
  
    
  <nav id="article-nav" class="wow fadeInUp">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img data-src="/covers/QQ图片20220927181409.jpg" data-sizes="auto" alt="数据库作业第八章" class="lazyload">
          
        
        <a href="/2024/04/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%9C%E4%B8%9A%E7%AC%AC%E5%85%AB%E7%AB%A0/"></a>
        <div class="article-nav-caption">前一篇</div>
        <h3 class="article-nav-title">
          
            数据库作业第八章
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        
        
          <img data-src="/covers/infinity-1977597.jpg" data-sizes="auto" alt="计算机系统复习" class="lazyload">
        
      
      <a href="/2024/04/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%A4%8D%E4%B9%A0(%E7%AE%97%E6%98%AF)/"></a>
      <div class="article-nav-caption">后一篇</div>
      <h3 class="article-nav-title">
        
          计算机系统复习
        
      </h3>
    </div>
    
  </nav>


  
</article>






</section>
          
        </div>
        <footer id="footer" class="wow fadeInUp">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div class="outer">
    <div id="footer-info" class="inner">
      
        [object Object]
      
      <div>
        <span class="icon-copyright"></span>
        2020-2024
        <span class="footer-info-sep"></span>
        Ycx.Cc
      </div>
      
        <div>
          基于&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>&nbsp;
          Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" target="_blank">Reimu</a>
        </div>
      
      
        <div>
          <span class="icon-brush"></span>
          52.2k
          &nbsp;|&nbsp;
          <span class="icon-coffee"></span>
          03:28
        </div>
      
      
        <div>
          <span class="icon-eye"></span>
          <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span>
          &nbsp;|&nbsp;
          <span class="icon-user"></span>
          <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span>
        </div>
      
    </div>
  </div>
</footer>

        <div class="sidebar-top">
          <img src="/images/taichi.png" height="50" width="50" />
          <div class="arrow-up"></div>
        </div>
        <div id="mask"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B62204-%E6%88%B4%E8%85%BE%E5%AE%87-202226010418"><span class="toc-number">1.</span> <span class="toc-text"> 软件2204 戴腾宇 202226010418</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-bomblab%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D"><span class="toc-number"></span> <span class="toc-text"> 一、bomblab相关介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text"> 1.简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.</span> <span class="toc-text"> 2.实验步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#21%E8%8E%B7%E5%8F%96bomb"><span class="toc-number">2.1.</span> <span class="toc-text"> 2.1.获取bomb</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#22%E6%8B%86%E9%99%A4bomb"><span class="toc-number">2.2.</span> <span class="toc-text"> 2.2.拆除bomb</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8"><span class="toc-number"></span> <span class="toc-text"> 二、工具使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number"></span> <span class="toc-text"> 三、准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E8%BF%9B%E8%A1%8C%E6%8B%86%E5%BC%B9"><span class="toc-number"></span> <span class="toc-text"> 四、进行拆弹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.</span> <span class="toc-text"> 1.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">2.</span> <span class="toc-text"> 2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">3.</span> <span class="toc-text"> 3.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-number">4.</span> <span class="toc-text"> 4.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5"><span class="toc-number">5.</span> <span class="toc-text"> 5.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6"><span class="toc-number">6.</span> <span class="toc-text"> 6.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#secret_phase"><span class="toc-number">7.</span> <span class="toc-text"> secret_phase</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8phase_defused%E4%B8%AD"><span class="toc-number">7.1.</span> <span class="toc-text"> 在phase_defused中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8serect_phase%E5%87%BD%E6%95%B0%E4%B8%AD"><span class="toc-number">7.2.</span> <span class="toc-text"> 在serect_phase函数中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8func7%E5%87%BD%E6%95%B0%E4%B8%AD"><span class="toc-number">7.3.</span> <span class="toc-text"> 在func7函数中</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number"></span> <span class="toc-text"> 五、实验总结</span></a></div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="Ycx.Cc" class="lazyload">
  <div class="sidebar-author-name">Ycx.Cc</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">21</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">7</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">16</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class=icon-github>
      <a href=https://github.com/Ycx6666 itemprop="url" target="_blank" aria-label="github"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    <div class="site-search">
      <div class="reimu-popup popup">
        <div class="reimu-search">
          <span class="reimu-search-input-icon"></span>
          <div class="reimu-search-input" id="reimu-search-input"></div>
        </div>
        <div class="reimu-results">
          <div id="reimu-stats"></div>
          <div id="reimu-hits"></div>
          <div id="reimu-pagination" class="reimu-pagination"></div>
        </div>
        <span class="popup-btn-close"></span>
      </div>
    </div>
    
<script src="https://npm.webcache.cn/jquery@3.7.1/dist/jquery.min.js"></script>


<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"></script>



  
<script src="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" async></script>






<script src="/js/pjax_script.js" data-pjax></script>













  
<script src="/js/generator_search.js"></script>

  
<script src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"></script>




  
<script src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"></script>

  
<script src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"></script>

  
<script src="/js/algolia_search.js"></script>

  <script>
    var CONFIG = {
      root: '/',
      algolia: {
        applicationID: "",
        apiKey: "ac97a6a139ee23819efc64577e213254",
        indexName: "hexo",
        hits: {
          "per_page": parseInt("4")
        },
        labels: {
          "input_placeholder": "搜索.....",
          "hits_empty": "未发现与 「${query}」相关内容",
          "hits_stats": "找到${hits}条结果(用时 ${time} ms)"
        }
      }
    };
  </script>



  
<script src="https://npm.webcache.cn/mouse-firework@0.0.4/dist/index.umd.js"></script>

  <script>
    firework(JSON.parse('{"excludeElements":["a"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>







<script src="/js/script.js"></script>



  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '0.1.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  

  <!-- hexo injector body_end start -->
<script src="/js/insert_highlight.js" data-pjax></script>
<!-- hexo injector body_end end --></body>
  </html>

