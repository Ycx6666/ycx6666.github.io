
  <!DOCTYPE html>
  <html lang="zh-CN"  >
  <head>
  <meta charset="utf-8">
  

  

  

  
  <title>
    Express |
    
    Ycx&#39;Blog
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CUbuntu%20Mono:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;">
  
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/regular.min.css">
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/solid.min.css">

  <link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/brands.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v5-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v4-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;">
  
<link rel="stylesheet" href="/css/loader.css">

  <meta name="description" content="Express            樱春雪                 湖南大学   | 软件工程   | 2204          1.初识Express  1.1Express简介  1.什么是Express  Express是基于Node.js平台，快速、开放、极简的Web开发框架   2.进一步理解 http内部模块使用很复杂，开发效率低；EXpress是基于http封装出来的。">
<meta property="og:type" content="article">
<meta property="og:title" content="Express">
<meta property="og:url" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="Ycx&#39;Blog">
<meta property="og:description" content="Express            樱春雪                 湖南大学   | 软件工程   | 2204          1.初识Express  1.1Express简介  1.什么是Express  Express是基于Node.js平台，快速、开放、极简的Web开发框架   2.进一步理解 http内部模块使用很复杂，开发效率低；EXpress是基于http封装出来的。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/7HN)MKDR%[2BI2$@Q69A8$H.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240325211442354.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240325212444542.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326163045849.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326163143550.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326163407998.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326164327361.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326164904111.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326165934807.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326172657669.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326172936210.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326174434765.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326174712500.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326174852564.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326200337095.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326200614669.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326202743866.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326203222926.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326213549750.png">
<meta property="og:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240327224520915.png">
<meta property="article:published_time" content="2019-11-21T05:44:57.000Z">
<meta property="article:modified_time" content="2024-04-15T10:47:00.251Z">
<meta property="article:author" content="Ycx.Cc">
<meta property="article:tag" content="express">
<meta property="article:tag" content="入门">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/7HN)MKDR%[2BI2$@Q69A8$H.png">
  
    <link rel="alternate" href="/atom.xml" title="Ycx'Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css">

  
  
  
  
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"></script>

  
    
<link rel="stylesheet" href="https://npm.webcache.cn/wowjs@1.1.3/css/libs/animate.css">

    
<script src="https://npm.webcache.cn/wowjs@1.1.3/dist/wow.min.js"></script>

    <script>
      new WOW({
        offset: 0,
        mobile: true,
        live: false
      }).init();
    </script>
  
  
    <script src="/sw.js"></script>
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg"></div>
    <div class="loading-right-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
          <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="#ff6e6b" />
          <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z" fill="#fd0d00" />
          <path d="M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95" fill="#fd0d00" />
        </svg>
      </div>
      <div class="loading-word">少女祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    const startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    const endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('load', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/">首页</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/archives">归档</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/about">关于</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/friend">友链</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="搜索"></a>
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="搜索"></a>
    
  </nav>
</div>
<header id="header">
  
    <img fetchpriority="high" src="/images/banner.jpg" alt="Express">
  
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div id="logo-wrap">
        
          
          
            <a href="/" id="logo">
              <h1>Express</h1>
            </a>
          
        
      </div>
      
        
        <h2 id="subtitle-wrap">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content" class="outer">
          
            <aside id="sidebar">
  <div class="sidebar-wrap wow fadeInRight wrap-sticky">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#express"><span class="toc-number">1.</span> <span class="toc-text"> Express</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text">
    樱春雪
  </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E5%88%9D%E8%AF%86express"><span class="toc-number">1.2.</span> <span class="toc-text"> 1.初识Express</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11express%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 1.1Express简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E4%BB%80%E4%B9%88%E6%98%AFexpress"><span class="toc-number">1.2.1.1.</span> <span class="toc-text"> 1.什么是Express</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%90%86%E8%A7%A3"><span class="toc-number">1.2.1.2.</span> <span class="toc-text"> 2.进一步理解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3express%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88"><span class="toc-number">1.2.1.3.</span> <span class="toc-text"> 3.Express能做什么</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12express%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 1.2Express的基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.2.1.</span> <span class="toc-text"> 1.安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%88%9B%E5%BB%BA%E6%9C%80%E5%9F%BA%E6%9C%ACweb%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.2.2.2.</span> <span class="toc-text"> 2.创建最基本Web服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E7%9B%91%E5%90%ACget%E8%AF%B7%E6%B1%82"><span class="toc-number">1.2.2.3.</span> <span class="toc-text"> 3.监听GET请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E7%9B%91%E5%90%ACpost%E8%AF%B7%E6%B1%82"><span class="toc-number">1.2.2.4.</span> <span class="toc-text"> 4.监听POST请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E6%8A%8A%E5%86%85%E5%AE%B9%E5%93%8D%E5%BA%94%E7%BB%99%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">1.2.2.5.</span> <span class="toc-text"> 5.把内容响应给客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E8%8E%B7%E5%8F%96url%E4%B8%AD%E6%90%BA%E5%B8%A6%E7%9A%84%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.2.6.</span> <span class="toc-text"> 6.获取URL中携带的查询参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E8%8E%B7%E5%8F%96url%E4%B8%AD%E7%9A%84%E5%8A%A8%E6%80%81%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.2.7.</span> <span class="toc-text"> 7.获取url中的动态参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E6%89%98%E7%AE%A1%E5%8A%A8%E6%80%81%E8%B5%84%E6%BA%90"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 1.3托管动态资源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1expressstatic"><span class="toc-number">1.2.3.1.</span> <span class="toc-text"> 1.express.static()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E6%89%98%E7%AE%A1%E5%A4%9A%E4%B8%AA%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9B%AE%E5%BD%95"><span class="toc-number">1.2.3.2.</span> <span class="toc-text"> 2.托管多个静态资源目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E6%8C%82%E8%BD%BD%E8%B7%AF%E5%BE%84%E5%89%8D%E7%BC%80"><span class="toc-number">1.2.3.3.</span> <span class="toc-text"> 3.挂载路径前缀</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14nodemon"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 1.4nodemon</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.4.1.</span> <span class="toc-text"> 1.为什么要使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.4.2.</span> <span class="toc-text"> 2.安装</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2express%E8%B7%AF%E7%94%B1"><span class="toc-number">1.3.</span> <span class="toc-text"> 2.Express路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 2.1介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22%E8%B7%AF%E7%94%B1%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 2.2路由的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E8%B7%AF%E7%94%B1"><span class="toc-number">1.3.2.1.</span> <span class="toc-text"> 1.最简单的路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E6%A8%A1%E5%9D%97%E5%8C%96%E8%B7%AF%E7%94%B1"><span class="toc-number">1.3.2.2.</span> <span class="toc-text"> 2.模块化路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E5%88%9B%E5%BB%BA%E8%B7%AF%E7%94%B1js%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.2.3.</span> <span class="toc-text"> 3.创建路由.js文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E5%A6%82%E4%BD%95%E6%B3%A8%E5%86%8C%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.2.4.</span> <span class="toc-text"> 4.如何注册路由模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E4%B8%BA%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97%E6%B7%BB%E5%8A%A0%E5%89%8D%E7%BC%80"><span class="toc-number">1.3.2.5.</span> <span class="toc-text"> 5.为路由模块添加前缀</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3express%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text"> 3.Express中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#31%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A6%82%E5%BF%B5"><span class="toc-number">1.4.1.</span> <span class="toc-text"> 3.1中间件概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12%E6%A6%82%E5%BF%B5%E7%AD%89%E7%AD%89"><span class="toc-number">1.4.1.1.</span> <span class="toc-text"> 1.2.概念等等</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3express%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="toc-number">1.4.1.2.</span> <span class="toc-text"> 3.Express中间件的调用流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4express%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.1.3.</span> <span class="toc-text"> 4.Express中间件的格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5next%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.4.1.4.</span> <span class="toc-text"> 5.next函数的作用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%87%BD%E6%95%B0"><span class="toc-number">1.4.2.</span> <span class="toc-text"> 3.2定义中间件函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%AE%9A%E4%B9%89"><span class="toc-number">1.4.2.1.</span> <span class="toc-text"> 1.定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%85%A8%E5%B1%80%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.2.</span> <span class="toc-text"> 2.全局生效的中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E7%AE%80%E5%8C%96%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.4.2.3.</span> <span class="toc-text"> 3.定义全局中间件的简化形式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.4.2.4.</span> <span class="toc-text"> 4.中间件的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E5%AE%9A%E4%B9%89%E5%A4%9A%E4%B8%AA%E5%85%A8%E5%B1%80%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.5.</span> <span class="toc-text"> 5.定义多个全局中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E5%B1%80%E9%83%A8%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.6.</span> <span class="toc-text"> 6.局部生效的中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E8%BF%9E%E7%BB%AD%E5%AE%9A%E4%B9%89%E5%A4%9A%E4%B8%AA%E5%B1%80%E9%83%A8%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.7.</span> <span class="toc-text"> 7.连续定义多个局部中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%BA%94%E4%B8%AA%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.4.2.8.</span> <span class="toc-text"> 8.中间件五个使用注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.3.</span> <span class="toc-text"> 3.3中间件分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB"><span class="toc-number">1.4.3.1.</span> <span class="toc-text"> 1.应用级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E8%B7%AF%E7%94%B1%E7%BA%A7%E5%88%AB"><span class="toc-number">1.4.3.2.</span> <span class="toc-text"> 2.路由级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E9%94%99%E8%AF%AF%E7%BA%A7%E5%88%AB"><span class="toc-number">1.4.3.3.</span> <span class="toc-text"> 3.错误级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4express%E5%86%85%E7%BD%AE%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.3.4.</span> <span class="toc-text"> 4.Express内置中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E7%AC%AC%E4%B8%89%E6%96%B9%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.3.5.</span> <span class="toc-text"> 5.第三方中间件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.4.</span> <span class="toc-text"> 3.4自定义中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.4.4.1.</span> <span class="toc-text"> 1.步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%AE%9A%E4%B9%89"><span class="toc-number">1.4.4.2.</span> <span class="toc-text"> 2.定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E7%9B%91%E5%90%ACreq%E7%9A%84data%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.4.4.3.</span> <span class="toc-text"> 3.监听req的data事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E7%9B%91%E5%90%ACreq%E7%9A%84end%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.4.4.4.</span> <span class="toc-text"> 4.监听req的end事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E4%BD%BF%E7%94%A8querystring%E8%A7%A3%E6%9E%90%E8%AF%B7%E6%B1%82%E4%BD%93%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.4.5.</span> <span class="toc-text"> 5.使用querystring解析请求体数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E5%B0%86%E8%A7%A3%E6%9E%90%E5%87%BA%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%B9%E8%B1%A1%E6%8C%82%E8%BD%BD%E4%B8%BAreqbody"><span class="toc-number">1.4.4.6.</span> <span class="toc-text"> 6.将解析出来的数据对象挂载为req.body</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E5%B0%86%E5%AD%90%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%B0%81%E8%A3%85%E4%B8%BA%E6%A8%A1%E5%9D%97"><span class="toc-number">1.4.4.7.</span> <span class="toc-text"> 7.将子定义中间件封装为模块</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E4%BD%BF%E7%94%A8express%E5%86%99%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.</span> <span class="toc-text"> 4.使用Express写接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#41%E5%88%9B%E5%BB%BA%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9A%84express%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.5.1.</span> <span class="toc-text"> 4.1创建最基本的Express服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42%E5%88%9B%E5%BB%BAapi%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.2.</span> <span class="toc-text"> 4.2创建API路由模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43%E7%BC%96%E5%86%99get%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.3.</span> <span class="toc-text"> 4.3编写GET接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44%E7%BC%96%E5%86%99post%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.4.</span> <span class="toc-text"> 4.4编写POST接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45cors%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB"><span class="toc-number">1.5.5.</span> <span class="toc-text"> 4.5CORS跨域资源共享</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E6%8E%A5%E5%8F%A3%E7%9A%84%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.5.1.</span> <span class="toc-text"> 1.接口的跨域问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E4%BD%BF%E7%94%A8cors%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.5.5.2.</span> <span class="toc-text"> 2.使用CORS中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E4%BB%80%E4%B9%88%E6%98%AFcors"><span class="toc-number">1.5.5.3.</span> <span class="toc-text"> 3.什么是CORS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4cors%E6%B3%A8%E6%84%8F"><span class="toc-number">1.5.5.4.</span> <span class="toc-text"> 4.cors注意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5cors%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-access-control-allow-origin"><span class="toc-number">1.5.5.5.</span> <span class="toc-text"> 5.cors响应头部- Access-Control-Allow-Origin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6cors%E5%93%8D%E5%BA%94%E5%A4%B4-access-control-allow-headers"><span class="toc-number">1.5.5.6.</span> <span class="toc-text"> 6.cors响应头 Access-Control-Allow-Headers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7cors%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-access-control-allow-methods"><span class="toc-number">1.5.5.7.</span> <span class="toc-text"> 7.cors响应头部 - Access-Control-Allow-Methods</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8cors%E8%AF%B7%E6%B1%82%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.5.8.</span> <span class="toc-text"> 8.cors请求的分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82"><span class="toc-number">1.5.5.9.</span> <span class="toc-text"> 9.简单请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82"><span class="toc-number">1.5.5.10.</span> <span class="toc-text"> 10.预检请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82%E5%92%8C%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.5.5.11.</span> <span class="toc-text"> 11.简单请求和预检请求的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46jsonp%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.6.</span> <span class="toc-text"> 4.6JSONP接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1jsonp%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E7%89%B9%E7%82%B9"><span class="toc-number">1.5.6.1.</span> <span class="toc-text"> 1.jsonp的概念和特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%88%9B%E5%BB%BAjsonp%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.5.6.2.</span> <span class="toc-text"> 2.创建jsonp接口的注意事项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E5%AE%9E%E7%8E%B0jsonp%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.6.3.</span> <span class="toc-text"> 3.实现jsonp接口</span></a></li></ol></li></ol></li></ol></li></ol></div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="Ycx.Cc" class="lazyload">
  <div class="sidebar-author-name">Ycx.Cc</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">21</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">7</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">16</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class=icon-github>
      <a href=https://github.com/Ycx6666 itemprop="url" target="_blank" aria-label="github"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>
</div>
    
    
      <div class="sidebar-btn-wrapper" style="position:static">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
    
  </div>

  
</aside>

          
          <section id="main"><article id="post-Express使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    <div class="article-meta">
      <div class="article-date wow slideInLeft">
  <a href="/2019/11/Express%E4%BD%BF%E7%94%A8/" class="article-date-link">
    <time datetime="2019-11-21T05:44:57.000Z" itemprop="datePublished">2019-11-21</time>
  </a>
</div>

      
  <div class="article-category wow slideInLeft">
    <a class="article-category-link" href="/categories/node-js/">node.js</a>
  </div>


    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="express"><a class="markdownIt-Anchor" href="#express"></a> Express</h1>
<p align="center">
  <br>
  </p><h2 style="text-align:center;color:#F4E0EA">
    樱春雪
  </h2>
  <br>
  <br>
  <div style="text-align:center">
    <a target="_blank" rel="noopener" href="https://codeload.github.com/liangjingkanji/DrakeTyporaTheme/zip/refs/heads/master">湖南大学</a>
  | <a target="_blank" rel="noopener" href="https://theme.typora.io/theme/Drake/">软件工程</a>
  | <a target="_blank" rel="noopener" href="https://github.com/liangjingkanji/DrakeTyporaTheme/blob/master/issues.md">2204</a>
</div>
<br>
<br>
<img style="clear:both;display:block;margin:auto;width:400px;height:100px" src="/2019/11/Express%E4%BD%BF%E7%94%A8/7HN)MKDR%[2BI2$@Q69A8$H.png">
  <br>
<p></p>
<h2 id="1初识express"><a class="markdownIt-Anchor" href="#1初识express"></a> 1.初识Express</h2>
<h3 id="11express简介"><a class="markdownIt-Anchor" href="#11express简介"></a> 1.1Express简介</h3>
<h4 id="1什么是express"><a class="markdownIt-Anchor" href="#1什么是express"></a> 1.什么是Express</h4>
<blockquote>
<p>Express是基于Node.js平台，快速、开放、极简的Web开发框架</p>
</blockquote>
<h4 id="2进一步理解"><a class="markdownIt-Anchor" href="#2进一步理解"></a> 2.进一步理解</h4>
<p>http内部模块使用很复杂，开发效率低；EXpress是基于http封装出来的。</p>
<h4 id="3express能做什么"><a class="markdownIt-Anchor" href="#3express能做什么"></a> 3.Express能做什么</h4>
<p>两种服务器</p>
<blockquote>
<p>Web网站服务器：专门提供Web网页的服务器</p>
<p>API接口服务器：专门提供API接口的服务器</p>
</blockquote>
<p><strong>使用Express，可以方便快捷的创建两种服务器</strong></p>
<h3 id="12express的基本使用"><a class="markdownIt-Anchor" href="#12express的基本使用"></a> 1.2Express的基本使用</h3>
<h4 id="1安装"><a class="markdownIt-Anchor" href="#1安装"></a> 1.安装</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express@4.17.1</span><br></pre></td></tr></table></figure>
<h4 id="2创建最基本web服务器"><a class="markdownIt-Anchor" href="#2创建最基本web服务器"></a> 2.创建最基本Web服务器</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.导入</span></span><br><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">//2.创建</span></span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()</span><br><span class="line"><span class="comment">//3.启动Web服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;express server running at localhost&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="3监听get请求"><a class="markdownIt-Anchor" href="#3监听get请求"></a> 3.监听GET请求</h4>
<p>通过app.get()方法，可以监听</p>
<p>具体语法格式如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;请求url&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;<span class="comment">//req 请求对象 res 响应对象</span></span><br><span class="line">  <span class="comment">/**待处理函数**/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="4监听post请求"><a class="markdownIt-Anchor" href="#4监听post请求"></a> 4.监听POST请求</h4>
<p>通过app.post()方法</p>
<p>具体格式如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;请求url&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;<span class="comment">//req 请求对象 res 响应对象</span></span><br><span class="line">  <span class="comment">/**待处理函数**/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="5把内容响应给客户端"><a class="markdownIt-Anchor" href="#5把内容响应给客户端"></a> 5.把内容响应给客户端</h4>
<p>通过res.send()方法，可以把处理好的内容，发送给客户端</p>
<p>这个方法既可以发送JSON字符串，也可以发送文本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//调用express提供的send方法相应一个对象</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;zs&#x27;</span>,<span class="attr">age</span>:<span class="number">20</span>,<span class="attr">gender</span>:<span class="string">&#x27;男&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;请求成功!&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="6获取url中携带的查询参数"><a class="markdownIt-Anchor" href="#6获取url中携带的查询参数"></a> 6.获取URL中携带的查询参数</h4>
<p>通过req.query对象，可以访问客户端通过查询字符穿的方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//默认是空对象</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">query</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="7获取url中的动态参数"><a class="markdownIt-Anchor" href="#7获取url中的动态参数"></a> 7.获取url中的动态参数</h4>
<p>通过<mark>req.params</mark>对象，可以访问到URL中，通过==：==匹配到的动态参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">params</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">params</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240325211442354.png" alt="image-20240325211442354"></p>
<p>也可以匹配两个至多个动态参数例如 <code>/:id/:name</code>，返回一个对象</p>
<h3 id="13托管动态资源"><a class="markdownIt-Anchor" href="#13托管动态资源"></a> 1.3托管动态资源</h3>
<h4 id="1expressstatic"><a class="markdownIt-Anchor" href="#1expressstatic"></a> 1.express.static()</h4>
<p>express提供了该函数，叫做express.static(),可以方便快捷的创建一个静态资源服务器</p>
<p>例如，通过以下代码就可以将public目录下的图片、CSS文件、Js文件对外开放访问了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>现在就可以访问public下所有问价了</p>
<p><mark>注意</mark></p>
<blockquote>
<p>Express在指定的静态目录中查找文件，存放文件的路径名不会出现在路径名中</p>
</blockquote>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240325212444542.png" alt="image-20240325212444542"></p>
<p>打开成功</p>
<h4 id="2托管多个静态资源目录"><a class="markdownIt-Anchor" href="#2托管多个静态资源目录"></a> 2.托管多个静态资源目录</h4>
<p>可以多次调用express.statci()函数</p>
<blockquote>
<p>访问静态资源时候，会按照顺序依次访问资源。</p>
</blockquote>
<h4 id="3挂载路径前缀"><a class="markdownIt-Anchor" href="#3挂载路径前缀"></a> 3.挂载路径前缀</h4>
<p>需要在托管的资源访问路径之前，挂载路径前缀</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/public&#x27;</span>,express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h3 id="14nodemon"><a class="markdownIt-Anchor" href="#14nodemon"></a> 1.4nodemon</h3>
<h4 id="1为什么要使用"><a class="markdownIt-Anchor" href="#1为什么要使用"></a> 1.为什么要使用</h4>
<blockquote>
<p>在编写Node.js项目的时候，如果修改了项目代码，需要频繁close掉，然后重新启动</p>
<p>使用nodemon之后，它可以监听项目文件的变动，当代码被修改之后，nodemon会帮助重启项目</p>
</blockquote>
<h4 id="2安装"><a class="markdownIt-Anchor" href="#2安装"></a> 2.安装</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g nodemon</span><br></pre></td></tr></table></figure>
<h2 id="2express路由"><a class="markdownIt-Anchor" href="#2express路由"></a> 2.Express路由</h2>
<h3 id="21介绍"><a class="markdownIt-Anchor" href="#21介绍"></a> 2.1介绍</h3>
<h3 id="22路由的使用"><a class="markdownIt-Anchor" href="#22路由的使用"></a> 2.2路由的使用</h3>
<h4 id="1最简单的路由"><a class="markdownIt-Anchor" href="#1最简单的路由"></a> 1.最简单的路由</h4>
<p>在Express中，最简单的路由的使用方式，就是把路由挂载到app上</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//来get</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;hello world&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//来post</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Post ing&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="2模块化路由"><a class="markdownIt-Anchor" href="#2模块化路由"></a> 2.模块化路由</h4>
<p>方便对路由进行模块化管理，不建议将路由直接挂载到app上，而是推荐<mark>将路由抽离为单独的模块</mark></p>
<p>将路由抽离为单独模块步骤</p>
<blockquote>
<ol>
<li>创建路由.js文件</li>
<li>调用express.static()方法创建路由对象</li>
<li>向路由对象上挂载具体的路由</li>
<li>室友moudule.exports向外共享路由对象</li>
<li>使用app.use函数注册路由模块</li>
</ol>
</blockquote>
<h4 id="3创建路由js文件"><a class="markdownIt-Anchor" href="#3创建路由js文件"></a> 3.创建路由.js文件</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">//创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"><span class="comment">//挂载具体的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/user/list&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Get user list.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;user/add&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Add new user successfully&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//向外导出</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=router</span><br></pre></td></tr></table></figure>
<h4 id="4如何注册路由模块"><a class="markdownIt-Anchor" href="#4如何注册路由模块"></a> 4.如何注册路由模块</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.导入路由模块</span></span><br><span class="line"><span class="keyword">const</span> router=<span class="built_in">require</span>(<span class="string">&#x27;./router&#x27;</span>)</span><br><span class="line"><span class="comment">//2.注册</span></span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>app.use()的作用就是用于注册全局的中间件</strong></p>
<h4 id="5为路由模块添加前缀"><a class="markdownIt-Anchor" href="#5为路由模块添加前缀"></a> 5.为路由模块添加前缀</h4>
<p>类似于为静态资源统一挂载前缀</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;api&#x27;</span>,router)</span><br></pre></td></tr></table></figure>
<h2 id="3express中间件"><a class="markdownIt-Anchor" href="#3express中间件"></a> 3.Express中间件</h2>
<h3 id="31中间件概念"><a class="markdownIt-Anchor" href="#31中间件概念"></a> 3.1中间件概念</h3>
<h4 id="12概念等等"><a class="markdownIt-Anchor" href="#12概念等等"></a> 1.2.概念等等</h4>
<p>略</p>
<h4 id="3express中间件的调用流程"><a class="markdownIt-Anchor" href="#3express中间件的调用流程"></a> 3.Express中间件的调用流程</h4>
<p>当一个请求到达Express的服务器之后，可以连续调用多个中间件，从而对这次请求进行预处理</p>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326163045849.png" alt="image-20240326163045849"></p>
<h4 id="4express中间件的格式"><a class="markdownIt-Anchor" href="#4express中间件的格式"></a> 4.Express中间件的格式</h4>
<p>中间件的本质就是一个function函数，其格式如下</p>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326163143550.png" alt="image-20240326163143550"></p>
<p><strong>中间间函数形参列表中，必须包含一个next形参，而路由处理函数中只有req、res</strong></p>
<p><mark>next形参必须放到最后一个</mark></p>
<h4 id="5next函数的作用"><a class="markdownIt-Anchor" href="#5next函数的作用"></a> 5.next函数的作用</h4>
<p><mark>next 函数是实现多个中间件连续调用的关键</mark>，他表示把流转关系转交给下一个中间件或路由</p>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326163407998.png" alt="image-20240326163407998"></p>
<h3 id="32定义中间件函数"><a class="markdownIt-Anchor" href="#32定义中间件函数"></a> 3.2定义中间件函数</h3>
<h4 id="1定义"><a class="markdownIt-Anchor" href="#1定义"></a> 1.定义</h4>
<p>可以通过如下方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个最简单的中间件函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw</span> = (<span class="params">req,res,next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;最简单的中间件函数&#x27;</span>)</span><br><span class="line">  <span class="comment">//把流转关系交给下一个中间件或者函数</span></span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Running&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="2全局生效的中间件"><a class="markdownIt-Anchor" href="#2全局生效的中间件"></a> 2.全局生效的中间件</h4>
<p>客户端发起的<strong>任何请求</strong>，到达服务器之后，都会触发的中间件，成为<mark>全局生效的中间件</mark></p>
<p>通过调用<strong>app.use(中间件函数)</strong>，即可定义一个全局生效的中间件，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(mw)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326164327361.png" alt="image-20240326164327361"></p>
<h4 id="3定义全局中间件的简化形式"><a class="markdownIt-Anchor" href="#3定义全局中间件的简化形式"></a> 3.定义全局中间件的简化形式</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;This is the app&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="4中间件的作用"><a class="markdownIt-Anchor" href="#4中间件的作用"></a> 4.中间件的作用</h4>
<blockquote>
<p>多个中间件之间，可以共享<strong>req和res</strong>，基于这样的特性，我么可以在上游的中间件中，<strong>统一为</strong>req或者res添加自定义属性或者方法，<strong>供下游</strong>中间件或者路由使用</p>
</blockquote>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326164904111.png" alt="image-20240326164904111">`</p>
<p>现在需要在每一个需求都获取时间</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> time=<span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Home page&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;This is get&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> time=<span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;User&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>在中间件函数中添加自定义属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//为req对象，添加自定义属性</span></span><br><span class="line">  <span class="keyword">const</span> time = <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">  <span class="comment">//添加自定义属性</span></span><br><span class="line">  req.<span class="property">startTime</span>=time</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;This is the app&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="5定义多个全局中间件"><a class="markdownIt-Anchor" href="#5定义多个全局中间件"></a> 5.定义多个全局中间件</h4>
<p>可以使用app.use连续定义多个全局中间件，客户端请求到达服务器之后，会按照前后顺序执行</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一个</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;第一个&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//第二个</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;第二个&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//路由</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;User page&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326165934807.png" alt="image-20240326165934807"></p>
<h4 id="6局部生效的中间件"><a class="markdownIt-Anchor" href="#6局部生效的中间件"></a> 6.局部生效的中间件</h4>
<blockquote>
<p>不使用app.use()定义的中间件，叫做局部生效的中间件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">mwl</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;局部生效&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Home page&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;User page&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这里面只有第一个路由才能被正确设置</p>
<h4 id="7连续定义多个局部中间件"><a class="markdownIt-Anchor" href="#7连续定义多个局部中间件"></a> 7.连续定义多个局部中间件</h4>
<p>可以如下定义，顺序从前到后:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.定义中间件函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mwl1</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;局部生效1&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mwl2</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;局部生效2&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,mwl1,mwl2,<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;<span class="comment">//(&#x27;/&#x27;,[mwl1,mwl2],(req,res))</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Home page&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="8中间件五个使用注意事项"><a class="markdownIt-Anchor" href="#8中间件五个使用注意事项"></a> 8.中间件五个使用注意事项</h4>
<blockquote>
<ol>
<li>一定要在路由之前注册中间件</li>
<li>客户但发送的请求可以连续调用多个中间件函数</li>
<li>执行完中间件业务代码后，一定要使用next()</li>
<li>在调用next()后，不用再写其他业务代码了，防止代码逻辑混乱</li>
<li>连续调用多个中间件，多个中间件之间是共享(req,res)对象的</li>
</ol>
</blockquote>
<h3 id="33中间件分类"><a class="markdownIt-Anchor" href="#33中间件分类"></a> 3.3中间件分类</h3>
<p><mark>常用的中间件分类</mark></p>
<blockquote>
<ol>
<li>应用级别</li>
<li>路由级别</li>
<li>错误级别</li>
<li>Express内置</li>
<li>第三方</li>
</ol>
</blockquote>
<h4 id="1应用级别"><a class="markdownIt-Anchor" href="#1应用级别"></a> 1.应用级别</h4>
<blockquote>
<p>通过app.use()/app.get()/app.post(),绑定到app实例上的中间件</p>
</blockquote>
<h4 id="2路由级别"><a class="markdownIt-Anchor" href="#2路由级别"></a> 2.路由级别</h4>
<blockquote>
<p>绑定到express.Router()实例上的，叫做路由级别中间件</p>
<blockquote>
<p><strong>差别</strong></p>
<p>应用级别中间件是绑定到app上，路由级别绑定到Router上</p>
</blockquote>
</blockquote>
<h4 id="3错误级别"><a class="markdownIt-Anchor" href="#3错误级别"></a> 3.错误级别</h4>
<p>**作用：**专门用来捕获整个项目中发生的异常错误，从而防止项目异常崩溃的问题</p>
<p>**格式：**错误级别中渐渐暗function()处理函数中，必须有四个形参，形参顺序从前到后</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">（err,req,res,next)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Error occured&#x27;</span>)</span><br><span class="line">  <span class="comment">//1.1人为制造错误</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Home page&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326172657669.png" alt="image-20240326172657669"></p>
<p><strong>使用错误级别中间件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Error occured&#x27;</span>)</span><br><span class="line">  <span class="comment">//1.1人为制造错误</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Home page&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//定义错误级别中间件，防止崩溃</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err,req,res,next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;发生了错误&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Error&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326172936210.png" alt="image-20240326172936210"></p>
<p><strong>程序没有崩溃</strong></p>
<blockquote>
<p>注意如果将中间件和路由调换顺序，还是会报错</p>
</blockquote>
<h4 id="4express内置中间件"><a class="markdownIt-Anchor" href="#4express内置中间件"></a> 4.Express内置中间件</h4>
<p>Express再4.16.0之后有三个常用中间件，</p>
<blockquote>
<p>express.static()快速托管静态资源的内置中间件，</p>
<p>express.json()解析JSON格式的请求体数据(有兼容性，再4.16.0及之后)</p>
<p>express.urlencoded()解析URL-encoded格式的请求日数据(有兼容性)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="property">json</span>)<span class="comment">//配置解析application/json格式化数据</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>:<span class="literal">false</span>&#125;))<span class="comment">//配置解析application/x-www-form-urlencoded格式数据的中间件</span></span><br></pre></td></tr></table></figure>
<p><mark>express.json()使用</mark></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//再服务器，可以使用req.body属性来接受来自客户端的请求体数据</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">  <span class="comment">//默认情况下，如果不配置解析表单数据的中间件，则req.body默认等于Undefined</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>输出Undefined</p>
<p><strong>注意，除了错误级别中间件，其他中间件必须在路由之前进行配置</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过express.json这个中间件解析</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//再服务器，可以使用req.body属性来接受来自客户端的请求体数据</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">  <span class="comment">//默认情况下，如果不配置解析表单数据的中间件，则req.body默认等于Undefined</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>成功输出json字符串</p>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326174434765.png" alt="image-20240326174434765"></p>
<p><mark>express.urlencoded()</mark></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/book&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326174712500.png" alt="image-20240326174712500"></p>
<p>解析不了，得到空对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过express.urlencoded()中间件来解析表单中的urlencoded</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326174852564.png" alt="image-20240326174852564"></p>
<p><strong>解析成功！</strong></p>
<h4 id="5第三方中间件"><a class="markdownIt-Anchor" href="#5第三方中间件"></a> 5.第三方中间件</h4>
<blockquote>
<p>非express官方的，由第三方出来的中间件，叫做第三方中间件</p>
</blockquote>
<p><strong>步骤</strong></p>
<p>例如安装 body-parser</p>
<ol>
<li>npm i body-parser</li>
<li>const parser=require(‘body-parser’)</li>
<li>app.use(parser.urlencoded({ extended: false }))</li>
</ol>
<p><strong>express中内置的express.urlencoded就是基于body-parser这个进一步封装的</strong></p>
<h3 id="34自定义中间件"><a class="markdownIt-Anchor" href="#34自定义中间件"></a> 3.4自定义中间件</h3>
<h4 id="1步骤"><a class="markdownIt-Anchor" href="#1步骤"></a> 1.步骤</h4>
<p>实现步骤：</p>
<ol>
<li>定义中间件</li>
<li>监听req的data事件</li>
<li>监听req的end事件</li>
<li>使用queryString模块解析请求体数据</li>
<li>将解析出来的数据对象挂载为req.body</li>
<li>将子定义中间件封装为模块</li>
</ol>
<h4 id="2定义"><a class="markdownIt-Anchor" href="#2定义"></a> 2.定义</h4>
<p>通过app.use()定义</p>
<h4 id="3监听req的data事件"><a class="markdownIt-Anchor" href="#3监听req的data事件"></a> 3.监听req的data事件</h4>
<p>通过监听req的data事件，就可以获取客户端发送到服务器的数据</p>
<p><strong>如果数据量比较大，客户端会把数据切割分批发送到服务器</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.定义变量存储客户端发送的请求体数据</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">//2.监听req的data事件</span></span><br><span class="line">req.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">  str+=chunk</span><br></pre></td></tr></table></figure>
<h4 id="4监听req的end事件"><a class="markdownIt-Anchor" href="#4监听req的end事件"></a> 4.监听req的end事件</h4>
<p>当end事件触发，代表数据接收完毕</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">req.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//在str村发的是完整的请求体数据</span></span><br><span class="line">    <span class="comment">//<span class="doctag">TODO:</span>把字符串请求体数据，转换成对象格式</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="5使用querystring解析请求体数据"><a class="markdownIt-Anchor" href="#5使用querystring解析请求体数据"></a> 5.使用querystring解析请求体数据</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> body = qs.<span class="title function_">parse</span>(str)</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(body)</span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326200337095.png" alt="image-20240326200337095"></p>
<h4 id="6将解析出来的数据对象挂载为reqbody"><a class="markdownIt-Anchor" href="#6将解析出来的数据对象挂载为reqbody"></a> 6.将解析出来的数据对象挂载为req.body</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">req.<span class="property">body</span> = body</span><br><span class="line"><span class="title function_">next</span>()</span><br></pre></td></tr></table></figure>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326200614669.png" alt="image-20240326200614669"></p>
<h4 id="7将子定义中间件封装为模块"><a class="markdownIt-Anchor" href="#7将子定义中间件封装为模块"></a> 7.将子定义中间件封装为模块</h4>
<p>为了优化代码，需要把子定义中间件封装为独立模块</p>
<h2 id="4使用express写接口"><a class="markdownIt-Anchor" href="#4使用express写接口"></a> 4.使用Express写接口</h2>
<h3 id="41创建最基本的express服务器"><a class="markdownIt-Anchor" href="#41创建最基本的express服务器"></a> 4.1创建最基本的Express服务器</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Running...&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="42创建api路由模块"><a class="markdownIt-Anchor" href="#42创建api路由模块"></a> 4.2创建API路由模块</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="property">Router</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Running&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="built_in">exports</span>(router)</span><br></pre></td></tr></table></figure>
<h3 id="43编写get接口"><a class="markdownIt-Anchor" href="#43编写get接口"></a> 4.3编写GET接口</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/get&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//通过req.query获取查询字符串，发送到服务器的数据</span></span><br><span class="line">  <span class="keyword">const</span> query = req.<span class="property">query</span></span><br><span class="line">  <span class="comment">//调用res.send()方法，向客户端相应处理的结果</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,<span class="comment">//0成功</span></span><br><span class="line">    <span class="attr">msg</span>: <span class="string">&#x27;GET 请求成功&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>:query</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>通过上述操作成功获得了数据</p>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326202743866.png" alt="image-20240326202743866"></p>
<h3 id="44编写post接口"><a class="markdownIt-Anchor" href="#44编写post接口"></a> 4.4编写POST接口</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/post&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//获取请求体包含的url-encoded格式数据</span></span><br><span class="line">  <span class="keyword">const</span> body = req.<span class="property">body</span></span><br><span class="line">  <span class="comment">//通过send方法，响应结果</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">msg</span>: <span class="string">&#x27;POST请求成功&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>:body</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>成功获取了表单数据</p>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326203222926.png" alt="image-20240326203222926"></p>
<h3 id="45cors跨域资源共享"><a class="markdownIt-Anchor" href="#45cors跨域资源共享"></a> 4.5CORS跨域资源共享</h3>
<h4 id="1接口的跨域问题"><a class="markdownIt-Anchor" href="#1接口的跨域问题"></a> 1.接口的跨域问题</h4>
<p><mark>严重的问题</mark></p>
<p>编写的接口不支持跨域问题。</p>
<p><strong>解决接口的跨域问题主要有两种方法</strong></p>
<blockquote>
<p>1.CORS(主流的解决方案，推荐)</p>
<p>2.JSONP(有缺陷，只支持GET)</p>
<p>也可以使用响应头</p>
</blockquote>
<h4 id="2使用cors中间件"><a class="markdownIt-Anchor" href="#2使用cors中间件"></a> 2.使用CORS中间件</h4>
<p>使用步骤</p>
<ol>
<li>
<p>运行 npm install cors</p>
</li>
<li>
<p>使用 const cors=require(‘cors’)</p>
</li>
<li>
<p>app.use(cors())</p>
</li>
</ol>
<h4 id="3什么是cors"><a class="markdownIt-Anchor" href="#3什么是cors"></a> 3.什么是CORS</h4>
<blockquote>
<p>cors跨区域资源共享由一系列HTTP响应头组成，这些HTTP响应头决定浏览器是否组织前端js代码是否共享</p>
</blockquote>
<h4 id="4cors注意"><a class="markdownIt-Anchor" href="#4cors注意"></a> 4.cors注意</h4>
<blockquote>
<ol>
<li>cors主要在服务器端进行部署，客户端浏览器无需做任何配置</li>
<li>cors在浏览器中由兼容性，支支持XMLHttpRequest Level2的浏览器，才能正常访问开启了cors的服务器端接口</li>
</ol>
</blockquote>
<h4 id="5cors响应头部-access-control-allow-origin"><a class="markdownIt-Anchor" href="#5cors响应头部-access-control-allow-origin"></a> 5.cors响应头部- Access-Control-Allow-Origin</h4>
<p>响应头部中携带一个 Access-Control-Allow-Origin 字段其语法如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Access</span>-<span class="title class_">Control</span>-<span class="title class_">Allow</span>-<span class="title class_">Origin</span>:&lt;origin&gt;|*</span><br></pre></td></tr></table></figure>
<p>其中 origin参数的值制定了允许访问人该资源的外域URL。</p>
<p>例如，下面字段将只允许来自<a target="_blank" rel="noopener" href="http://itcast.xn--cn-ut1e588ap40a">http://itcast.cn的请求</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="string">&#x27;http//itcast.cn&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>*****号代表通配符，表示允许任何域名请求</p>
<h4 id="6cors响应头-access-control-allow-headers"><a class="markdownIt-Anchor" href="#6cors响应头-access-control-allow-headers"></a> 6.cors响应头 Access-Control-Allow-Headers</h4>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240326213549750.png" alt="image-20240326213549750"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//允许客户端向服务器发送 Content-Type请求头和 X-Custom-Header请求头</span></span><br><span class="line"><span class="comment">//多个请求头之间用 “，”分隔</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>,<span class="string">&#x27;Content-Type,X-Custom-Header&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="7cors响应头部-access-control-allow-methods"><a class="markdownIt-Anchor" href="#7cors响应头部-access-control-allow-methods"></a> 7.cors响应头部 - Access-Control-Allow-Methods</h4>
<p>默认情况下，cors仅支持客户端发起<mark>GET、POST、HEAD</mark>请求</p>
<p>如果客户端希望通过 <mark>PUT、DELETE</mark>等方式请求服务器，需要在该响应头指明允许所使用的HTTP方法</p>
<h4 id="8cors请求的分类"><a class="markdownIt-Anchor" href="#8cors请求的分类"></a> 8.cors请求的分类</h4>
<p>简单请求、预检请求</p>
<h4 id="9简单请求"><a class="markdownIt-Anchor" href="#9简单请求"></a> 9.简单请求</h4>
<p><img src="/2019/11/Express%E4%BD%BF%E7%94%A8/image-20240327224520915.png" alt="image-20240327224520915"></p>
<h4 id="10预检请求"><a class="markdownIt-Anchor" href="#10预检请求"></a> 10.预检请求</h4>
<p>符合以下任何一个条件按</p>
<blockquote>
<ol>
<li>请求方式为GET\POST\HEAD之外的Method类型</li>
<li>请求头中包含自定义头部字段</li>
<li>向服务器发送了application\json格式的数据</li>
</ol>
</blockquote>
<p>在浏览器和服务器正式通信之前，浏览器会先发送OPTION请求进行预检，以获知服务器是否允许该实际请求，**服务器成功响应预检请求之后，才会发送真正的请求，并且携带真实数据。</p>
<h4 id="11简单请求和预检请求的区别"><a class="markdownIt-Anchor" href="#11简单请求和预检请求的区别"></a> 11.简单请求和预检请求的区别</h4>
<blockquote>
<p>网络请求的特点：客户端和服务器之间之会发生一次请求</p>
<p>预检请求的特点：客户端与服务器直接会发生两次请求，OPTION预检请求成功之后，才会发其真正的请求</p>
</blockquote>
<h3 id="46jsonp接口"><a class="markdownIt-Anchor" href="#46jsonp接口"></a> 4.6JSONP接口</h3>
<h4 id="1jsonp的概念和特点"><a class="markdownIt-Anchor" href="#1jsonp的概念和特点"></a> 1.jsonp的概念和特点</h4>
<p><strong>概念</strong></p>
<p>浏览器通过<scirpt>标签的src属性，请求服务器上的数据，同时，服务器返回一个函数的调用，这种请求的方式叫做jsonp。</scirpt></p>
<hr>
<p><strong>特点</strong></p>
<ol>
<li>jsonp不属于真正的ajax请求，因为他没有使用XMLHTTPRequest这个对象</li>
<li>jsonp仅支持GET请求，不支持其他请求</li>
</ol>
<h4 id="2创建jsonp接口的注意事项"><a class="markdownIt-Anchor" href="#2创建jsonp接口的注意事项"></a> 2.创建jsonp接口的注意事项</h4>
<p>如果已经配置了CORS跨域资源共享，必须在配置CORS之前配置jsonp接口</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/jsonp&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//TODO 创建</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//必须在配置cors之前配置jsonp</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br></pre></td></tr></table></figure>
<h4 id="3实现jsonp接口"><a class="markdownIt-Anchor" href="#3实现jsonp接口"></a> 3.实现jsonp接口</h4>
<p><strong>步骤：</strong></p>
<blockquote>
<ol>
<li>获取客户端发送过来的回调函数的名字</li>
<li>得到通过jsonp形式发送给客户端的数据</li>
<li>根据前两步得到的数据，拼接处一个函数调用的字符串</li>
<li>把上一步拼接得到的字符串，响应给客户端<script>标签进行解析执行。</li>
</ol>
</blockquote>
<h4 id="4具体步骤"><a class="markdownIt-Anchor" href="#4具体步骤"></a> 4.具体步骤</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//TODO 创建</span></span><br><span class="line">  <span class="comment">//得到函数名称</span></span><br><span class="line">  <span class="keyword">const</span> funcName = req.<span class="property">query</span>.<span class="property">callback</span></span><br><span class="line">  <span class="comment">//2.得到数据对象</span></span><br><span class="line">  <span class="keyword">const</span> data = &#123; <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>, <span class="attr">age</span>: <span class="string">&#x27;20&#x27;</span> &#125;</span><br><span class="line">  <span class="comment">//拼接</span></span><br><span class="line">  <span class="keyword">const</span> str = <span class="string">`<span class="subst">$&#123;funcName&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span></span><br><span class="line">  <span class="comment">//响应</span></span><br><span class="line">  res.<span class="title function_">send</span>(str)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="5使用jquery发起jsonp请求"><a class="markdownIt-Anchor" href="#5使用jquery发起jsonp请求"></a> 5.使用JQUERY发起jsonp请求</h4>
<p>略</p>
</script></li></ol></blockquote>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://ycx6666.github.io/2019/11/Express%E4%BD%BF%E7%94%A8/" data-id="clv0tz8dm0002v0mc0xtq2wn5" data-title="Express" class="article-share-link">分享</a>
      
      
      
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/express/" rel="tag">express</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%85%A5%E9%97%A8/" rel="tag">入门</a></li></ul>


    </footer>
  </div>
  
    
  <nav id="article-nav" class="wow fadeInUp">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img data-src="/covers/infinity-1977597.jpg" data-sizes="auto" alt="计算机系统第四章课后作业" class="lazyload">
          
        
        <a href="/2024/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E4%BD%9C%E4%B8%9A2.71-3.66/"></a>
        <div class="article-nav-caption">前一篇</div>
        <h3 class="article-nav-title">
          
            计算机系统第四章课后作业
          
        </h3>
      </div>
    
    
  </nav>


  
</article>






</section>
          
        </div>
        <footer id="footer" class="wow fadeInUp">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div class="outer">
    <div id="footer-info" class="inner">
      
        [object Object]
      
      <div>
        <span class="icon-copyright"></span>
        2020-2024
        <span class="footer-info-sep"></span>
        Ycx.Cc
      </div>
      
        <div>
          基于&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>&nbsp;
          Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" target="_blank">Reimu</a>
        </div>
      
      
        <div>
          <span class="icon-brush"></span>
          52.2k
          &nbsp;|&nbsp;
          <span class="icon-coffee"></span>
          03:28
        </div>
      
      
        <div>
          <span class="icon-eye"></span>
          <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span>
          &nbsp;|&nbsp;
          <span class="icon-user"></span>
          <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span>
        </div>
      
    </div>
  </div>
</footer>

        <div class="sidebar-top">
          <img src="/images/taichi.png" height="50" width="50" />
          <div class="arrow-up"></div>
        </div>
        <div id="mask"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#express"><span class="toc-number">1.</span> <span class="toc-text"> Express</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text">
    樱春雪
  </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E5%88%9D%E8%AF%86express"><span class="toc-number">1.2.</span> <span class="toc-text"> 1.初识Express</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11express%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 1.1Express简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E4%BB%80%E4%B9%88%E6%98%AFexpress"><span class="toc-number">1.2.1.1.</span> <span class="toc-text"> 1.什么是Express</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%90%86%E8%A7%A3"><span class="toc-number">1.2.1.2.</span> <span class="toc-text"> 2.进一步理解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3express%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88"><span class="toc-number">1.2.1.3.</span> <span class="toc-text"> 3.Express能做什么</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12express%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 1.2Express的基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.2.1.</span> <span class="toc-text"> 1.安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%88%9B%E5%BB%BA%E6%9C%80%E5%9F%BA%E6%9C%ACweb%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.2.2.2.</span> <span class="toc-text"> 2.创建最基本Web服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E7%9B%91%E5%90%ACget%E8%AF%B7%E6%B1%82"><span class="toc-number">1.2.2.3.</span> <span class="toc-text"> 3.监听GET请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E7%9B%91%E5%90%ACpost%E8%AF%B7%E6%B1%82"><span class="toc-number">1.2.2.4.</span> <span class="toc-text"> 4.监听POST请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E6%8A%8A%E5%86%85%E5%AE%B9%E5%93%8D%E5%BA%94%E7%BB%99%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">1.2.2.5.</span> <span class="toc-text"> 5.把内容响应给客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E8%8E%B7%E5%8F%96url%E4%B8%AD%E6%90%BA%E5%B8%A6%E7%9A%84%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.2.6.</span> <span class="toc-text"> 6.获取URL中携带的查询参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E8%8E%B7%E5%8F%96url%E4%B8%AD%E7%9A%84%E5%8A%A8%E6%80%81%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.2.7.</span> <span class="toc-text"> 7.获取url中的动态参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E6%89%98%E7%AE%A1%E5%8A%A8%E6%80%81%E8%B5%84%E6%BA%90"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 1.3托管动态资源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1expressstatic"><span class="toc-number">1.2.3.1.</span> <span class="toc-text"> 1.express.static()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E6%89%98%E7%AE%A1%E5%A4%9A%E4%B8%AA%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9B%AE%E5%BD%95"><span class="toc-number">1.2.3.2.</span> <span class="toc-text"> 2.托管多个静态资源目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E6%8C%82%E8%BD%BD%E8%B7%AF%E5%BE%84%E5%89%8D%E7%BC%80"><span class="toc-number">1.2.3.3.</span> <span class="toc-text"> 3.挂载路径前缀</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14nodemon"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 1.4nodemon</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.4.1.</span> <span class="toc-text"> 1.为什么要使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.4.2.</span> <span class="toc-text"> 2.安装</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2express%E8%B7%AF%E7%94%B1"><span class="toc-number">1.3.</span> <span class="toc-text"> 2.Express路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 2.1介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22%E8%B7%AF%E7%94%B1%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 2.2路由的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E8%B7%AF%E7%94%B1"><span class="toc-number">1.3.2.1.</span> <span class="toc-text"> 1.最简单的路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E6%A8%A1%E5%9D%97%E5%8C%96%E8%B7%AF%E7%94%B1"><span class="toc-number">1.3.2.2.</span> <span class="toc-text"> 2.模块化路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E5%88%9B%E5%BB%BA%E8%B7%AF%E7%94%B1js%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.2.3.</span> <span class="toc-text"> 3.创建路由.js文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E5%A6%82%E4%BD%95%E6%B3%A8%E5%86%8C%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.2.4.</span> <span class="toc-text"> 4.如何注册路由模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E4%B8%BA%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97%E6%B7%BB%E5%8A%A0%E5%89%8D%E7%BC%80"><span class="toc-number">1.3.2.5.</span> <span class="toc-text"> 5.为路由模块添加前缀</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3express%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text"> 3.Express中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#31%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A6%82%E5%BF%B5"><span class="toc-number">1.4.1.</span> <span class="toc-text"> 3.1中间件概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12%E6%A6%82%E5%BF%B5%E7%AD%89%E7%AD%89"><span class="toc-number">1.4.1.1.</span> <span class="toc-text"> 1.2.概念等等</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3express%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="toc-number">1.4.1.2.</span> <span class="toc-text"> 3.Express中间件的调用流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4express%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.1.3.</span> <span class="toc-text"> 4.Express中间件的格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5next%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.4.1.4.</span> <span class="toc-text"> 5.next函数的作用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%87%BD%E6%95%B0"><span class="toc-number">1.4.2.</span> <span class="toc-text"> 3.2定义中间件函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%AE%9A%E4%B9%89"><span class="toc-number">1.4.2.1.</span> <span class="toc-text"> 1.定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%85%A8%E5%B1%80%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.2.</span> <span class="toc-text"> 2.全局生效的中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E7%AE%80%E5%8C%96%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.4.2.3.</span> <span class="toc-text"> 3.定义全局中间件的简化形式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.4.2.4.</span> <span class="toc-text"> 4.中间件的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E5%AE%9A%E4%B9%89%E5%A4%9A%E4%B8%AA%E5%85%A8%E5%B1%80%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.5.</span> <span class="toc-text"> 5.定义多个全局中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E5%B1%80%E9%83%A8%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.6.</span> <span class="toc-text"> 6.局部生效的中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E8%BF%9E%E7%BB%AD%E5%AE%9A%E4%B9%89%E5%A4%9A%E4%B8%AA%E5%B1%80%E9%83%A8%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.2.7.</span> <span class="toc-text"> 7.连续定义多个局部中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%BA%94%E4%B8%AA%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.4.2.8.</span> <span class="toc-text"> 8.中间件五个使用注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.3.</span> <span class="toc-text"> 3.3中间件分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB"><span class="toc-number">1.4.3.1.</span> <span class="toc-text"> 1.应用级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E8%B7%AF%E7%94%B1%E7%BA%A7%E5%88%AB"><span class="toc-number">1.4.3.2.</span> <span class="toc-text"> 2.路由级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E9%94%99%E8%AF%AF%E7%BA%A7%E5%88%AB"><span class="toc-number">1.4.3.3.</span> <span class="toc-text"> 3.错误级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4express%E5%86%85%E7%BD%AE%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.3.4.</span> <span class="toc-text"> 4.Express内置中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E7%AC%AC%E4%B8%89%E6%96%B9%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.3.5.</span> <span class="toc-text"> 5.第三方中间件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.4.4.</span> <span class="toc-text"> 3.4自定义中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.4.4.1.</span> <span class="toc-text"> 1.步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%AE%9A%E4%B9%89"><span class="toc-number">1.4.4.2.</span> <span class="toc-text"> 2.定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E7%9B%91%E5%90%ACreq%E7%9A%84data%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.4.4.3.</span> <span class="toc-text"> 3.监听req的data事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E7%9B%91%E5%90%ACreq%E7%9A%84end%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.4.4.4.</span> <span class="toc-text"> 4.监听req的end事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E4%BD%BF%E7%94%A8querystring%E8%A7%A3%E6%9E%90%E8%AF%B7%E6%B1%82%E4%BD%93%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.4.5.</span> <span class="toc-text"> 5.使用querystring解析请求体数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E5%B0%86%E8%A7%A3%E6%9E%90%E5%87%BA%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%B9%E8%B1%A1%E6%8C%82%E8%BD%BD%E4%B8%BAreqbody"><span class="toc-number">1.4.4.6.</span> <span class="toc-text"> 6.将解析出来的数据对象挂载为req.body</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E5%B0%86%E5%AD%90%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%B0%81%E8%A3%85%E4%B8%BA%E6%A8%A1%E5%9D%97"><span class="toc-number">1.4.4.7.</span> <span class="toc-text"> 7.将子定义中间件封装为模块</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E4%BD%BF%E7%94%A8express%E5%86%99%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.</span> <span class="toc-text"> 4.使用Express写接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#41%E5%88%9B%E5%BB%BA%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9A%84express%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.5.1.</span> <span class="toc-text"> 4.1创建最基本的Express服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42%E5%88%9B%E5%BB%BAapi%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.2.</span> <span class="toc-text"> 4.2创建API路由模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43%E7%BC%96%E5%86%99get%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.3.</span> <span class="toc-text"> 4.3编写GET接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44%E7%BC%96%E5%86%99post%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.4.</span> <span class="toc-text"> 4.4编写POST接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45cors%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB"><span class="toc-number">1.5.5.</span> <span class="toc-text"> 4.5CORS跨域资源共享</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E6%8E%A5%E5%8F%A3%E7%9A%84%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.5.1.</span> <span class="toc-text"> 1.接口的跨域问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E4%BD%BF%E7%94%A8cors%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.5.5.2.</span> <span class="toc-text"> 2.使用CORS中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E4%BB%80%E4%B9%88%E6%98%AFcors"><span class="toc-number">1.5.5.3.</span> <span class="toc-text"> 3.什么是CORS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4cors%E6%B3%A8%E6%84%8F"><span class="toc-number">1.5.5.4.</span> <span class="toc-text"> 4.cors注意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5cors%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-access-control-allow-origin"><span class="toc-number">1.5.5.5.</span> <span class="toc-text"> 5.cors响应头部- Access-Control-Allow-Origin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6cors%E5%93%8D%E5%BA%94%E5%A4%B4-access-control-allow-headers"><span class="toc-number">1.5.5.6.</span> <span class="toc-text"> 6.cors响应头 Access-Control-Allow-Headers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7cors%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-access-control-allow-methods"><span class="toc-number">1.5.5.7.</span> <span class="toc-text"> 7.cors响应头部 - Access-Control-Allow-Methods</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8cors%E8%AF%B7%E6%B1%82%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.5.8.</span> <span class="toc-text"> 8.cors请求的分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82"><span class="toc-number">1.5.5.9.</span> <span class="toc-text"> 9.简单请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82"><span class="toc-number">1.5.5.10.</span> <span class="toc-text"> 10.预检请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82%E5%92%8C%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.5.5.11.</span> <span class="toc-text"> 11.简单请求和预检请求的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46jsonp%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.6.</span> <span class="toc-text"> 4.6JSONP接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1jsonp%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E7%89%B9%E7%82%B9"><span class="toc-number">1.5.6.1.</span> <span class="toc-text"> 1.jsonp的概念和特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%88%9B%E5%BB%BAjsonp%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.5.6.2.</span> <span class="toc-text"> 2.创建jsonp接口的注意事项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E5%AE%9E%E7%8E%B0jsonp%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.6.3.</span> <span class="toc-text"> 3.实现jsonp接口</span></a></li></ol></li></ol></li></ol></li></ol></div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="Ycx.Cc" class="lazyload">
  <div class="sidebar-author-name">Ycx.Cc</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">21</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">7</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">16</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class=icon-github>
      <a href=https://github.com/Ycx6666 itemprop="url" target="_blank" aria-label="github"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    <div class="site-search">
      <div class="reimu-popup popup">
        <div class="reimu-search">
          <span class="reimu-search-input-icon"></span>
          <div class="reimu-search-input" id="reimu-search-input"></div>
        </div>
        <div class="reimu-results">
          <div id="reimu-stats"></div>
          <div id="reimu-hits"></div>
          <div id="reimu-pagination" class="reimu-pagination"></div>
        </div>
        <span class="popup-btn-close"></span>
      </div>
    </div>
    
<script src="https://npm.webcache.cn/jquery@3.7.1/dist/jquery.min.js"></script>


<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"></script>



  
<script src="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" async></script>






<script src="/js/pjax_script.js" data-pjax></script>













  
<script src="/js/generator_search.js"></script>

  
<script src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"></script>




  
<script src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"></script>

  
<script src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"></script>

  
<script src="/js/algolia_search.js"></script>

  <script>
    var CONFIG = {
      root: '/',
      algolia: {
        applicationID: "",
        apiKey: "ac97a6a139ee23819efc64577e213254",
        indexName: "hexo",
        hits: {
          "per_page": parseInt("4")
        },
        labels: {
          "input_placeholder": "搜索.....",
          "hits_empty": "未发现与 「${query}」相关内容",
          "hits_stats": "找到${hits}条结果(用时 ${time} ms)"
        }
      }
    };
  </script>



  
<script src="https://npm.webcache.cn/mouse-firework@0.0.4/dist/index.umd.js"></script>

  <script>
    firework(JSON.parse('{"excludeElements":["a"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>







<script src="/js/script.js"></script>



  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '0.1.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  

  <!-- hexo injector body_end start -->
<script src="/js/insert_highlight.js" data-pjax></script>
<!-- hexo injector body_end end --></body>
  </html>

